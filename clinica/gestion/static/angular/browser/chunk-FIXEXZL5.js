import{a as Z}from"./chunk-ZJXPOUTS.js";import{a as X,b as Y}from"./chunk-IGMEQJMD.js";import{a as D,b as z,c as q,d as B,e as L,f as $,g as U,h as G,i as R,j as J,k as K,l as Q}from"./chunk-TKT4RXFG.js";import{Da as f,Db as I,Eb as T,Fb as F,Jb as j,N as V,Oa as u,Pa as i,Pb as W,Qa as n,R as A,Ra as g,Rb as N,Sa as E,Ta as S,Ua as v,Va as p,Wa as s,X as m,Y as _,_a as w,a as P,ab as a,bb as h,cb as y,fb as b,gb as x,hb as M,kb as O,pa as d,ta as C,za as k}from"./chunk-LWXCOFDW.js";var H=class c{constructor(t,e){this.http=t;this.auth=e}baseUrl="/api/admin";authHeaders(){let t=this.auth.obtenerToken()||"";return new W({Authorization:`Bearer ${t}`})}listar(t){return this.http.get(`${this.baseUrl}/medicos/${t}/horarios/`,{headers:this.authHeaders()})}crear(t,e){return this.http.post(`${this.baseUrl}/medicos/${t}/horarios/`,e,{headers:this.authHeaders()})}actualizar(t,e){return this.http.put(`${this.baseUrl}/horarios/${t}/`,e,{headers:this.authHeaders()})}eliminar(t){return this.http.delete(`${this.baseUrl}/horarios/${t}/`,{headers:this.authHeaders()})}static \u0275fac=function(e){return new(e||c)(A(N),A(X))};static \u0275prov=V({token:c,factory:c.\u0275fac,providedIn:"root"})};var ne=c=>({"table-info":c});function re(c,t){if(c&1&&(i(0,"div",7),a(1),n()),c&2){let e=s();d(),h(e.mensaje)}}function oe(c,t){c&1&&(i(0,"div",20),g(1,"div",21),i(2,"p",22),a(3,"Cargando m\xE9dicos..."),n()())}function ae(c,t){c&1&&(i(0,"div",23),g(1,"i",24),i(2,"h4"),a(3,"No se encontraron m\xE9dicos"),n(),i(4,"p"),a(5,"Prueba con otro t\xE9rmino de b\xFAsqueda o a\xF1ade un nuevo m\xE9dico."),n()())}function ce(c,t){if(c&1){let e=v();i(0,"tr")(1,"td"),a(2),n(),i(3,"td"),a(4),n(),i(5,"td"),a(6),n(),i(7,"td",27)(8,"button",29),p("click",function(){let o=m(e).$implicit,l=s(3);return _(l.verHorarios(o))}),g(9,"i",30),a(10," Horarios "),n(),i(11,"button",31),p("click",function(){let o=m(e).$implicit,l=s(3);return _(l.editarMedico(o))}),g(12,"i",32),a(13," Editar "),n(),i(14,"button",33),p("click",function(){let o=m(e).$implicit,l=s(3);return _(l.eliminarMedico(o))}),g(15,"i",34),a(16," Eliminar "),n()()()}if(c&2){let e=t.$implicit,r=s(3);d(2),h(e.nombres),d(2),h(e.correo),d(2),h(r.nombreDeEspecialidad(e.especialidad))}}function de(c,t){if(c&1&&(i(0,"div",25)(1,"table",26)(2,"thead")(3,"tr")(4,"th"),a(5,"Nombre"),n(),i(6,"th"),a(7,"Correo"),n(),i(8,"th"),a(9,"Especialidad"),n(),i(10,"th",27),a(11,"Acciones"),n()()(),i(12,"tbody"),f(13,ce,17,3,"tr",28),n()()()),c&2){let e=s(2);d(13),u("ngForOf",e.medicos)}}function le(c,t){if(c&1){let e=v();E(0),i(1,"div",8)(2,"div",9)(3,"div",10)(4,"div",11)(5,"input",12),M("ngModelChange",function(o){m(e);let l=s();return x(l.busqueda,o)||(l.busqueda=o),_(o)}),p("keyup.enter",function(){m(e);let o=s();return _(o.buscar())}),n(),i(6,"button",13),p("click",function(){m(e);let o=s();return _(o.buscar())}),g(7,"i",14),n()(),i(8,"button",15),p("click",function(){m(e);let o=s();return _(o.nuevoMedico())}),g(9,"i",16),a(10,"A\xF1adir M\xE9dico "),n()(),f(11,oe,4,0,"div",17)(12,ae,6,0,"div",18)(13,de,14,1,"div",19),n()(),S()}if(c&2){let e=s();d(5),b("ngModel",e.busqueda),d(6),u("ngIf",e.cargando),d(),u("ngIf",!e.cargando&&e.medicos.length===0),d(),u("ngIf",!e.cargando&&e.medicos.length>0)}}function se(c,t){if(c&1&&(i(0,"option",49),a(1),n()),c&2){let e=t.$implicit;u("ngValue",e.id),d(),h(e.nombre)}}function me(c,t){if(c&1){let e=v();E(0),i(1,"div",8)(2,"div",35)(3,"h4",36),a(4),n()(),i(5,"div",9)(6,"form",37,0),p("ngSubmit",function(){m(e);let o=s();return _(o.guardarMedico())}),i(8,"div",38)(9,"label",39),a(10,"Nombres"),n(),i(11,"input",40),M("ngModelChange",function(o){m(e);let l=s();return x(l.formMedico.nombres,o)||(l.formMedico.nombres=o),_(o)}),n()(),i(12,"div",38)(13,"label",39),a(14,"Correo"),n(),i(15,"input",41),M("ngModelChange",function(o){m(e);let l=s();return x(l.formMedico.correo,o)||(l.formMedico.correo=o),_(o)}),n()(),i(16,"div",38)(17,"label",39),a(18,"Especialidad"),n(),i(19,"select",42),M("ngModelChange",function(o){m(e);let l=s();return x(l.formMedico.especialidad,o)||(l.formMedico.especialidad=o),_(o)}),i(20,"option",43),a(21,"-- Seleccione una especialidad --"),n(),f(22,se,2,2,"option",44),n()()()(),i(23,"div",45)(24,"button",46),p("click",function(){m(e);let o=s();return _(o.cancelarMedico())}),a(25,"Cancelar"),n(),i(26,"button",47),p("click",function(){m(e);let o=s();return _(o.guardarMedico())}),g(27,"i",48),a(28),n()()(),S()}if(c&2){let e=w(7),r=s();d(4),h(r.modo==="crear"?"A\xF1adir Nuevo M\xE9dico":"Editar M\xE9dico"),d(7),b("ngModel",r.formMedico.nombres),d(4),b("ngModel",r.formMedico.correo),d(4),b("ngModel",r.formMedico.especialidad),d(),u("ngValue",null),d(2),u("ngForOf",r.especialidades),d(4),u("disabled",e.invalid),d(2),y(" ",r.modo==="crear"?"Crear M\xE9dico":"Guardar Cambios"," ")}}function _e(c,t){c&1&&(i(0,"div",20),a(1,"Cargando horarios..."),n())}function ue(c,t){c&1&&(i(0,"div",23),g(1,"i",67),i(2,"h4"),a(3,"No hay horarios registrados"),n(),i(4,"p"),a(5,"A\xF1ade un nuevo horario para este m\xE9dico en el formulario de abajo."),n()())}function pe(c,t){if(c&1){let e=v();i(0,"tr",70)(1,"td"),a(2),n(),i(3,"td"),a(4),n(),i(5,"td")(6,"span",71),a(7),n()(),i(8,"td",27)(9,"button",72),p("click",function(){let o=m(e).$implicit,l=s(3);return _(l.editarHorario(o))}),g(10,"i",32),a(11," Editar "),n(),i(12,"button",73),p("click",function(){let o=m(e).$implicit,l=s(3);return _(l.eliminarHorario(o))}),g(13,"i",34),a(14," Eliminar "),n()()()}if(c&2){let e=t.$implicit,r=s(3);u("ngClass",O(5,ne,r.modoHorario==="editar"&&e.id===r.formHorario.id)),d(2),h(e.fecha),d(2),h(e.hora),d(2),u("ngClass",e.disponible?"bg-success":"bg-secondary"),d(),y(" ",e.disponible?"S\xED":"No"," ")}}function ge(c,t){if(c&1&&(i(0,"div",25)(1,"table",68)(2,"thead")(3,"tr")(4,"th"),a(5,"Fecha"),n(),i(6,"th"),a(7,"Hora"),n(),i(8,"th"),a(9,"Disponible"),n(),i(10,"th",27),a(11,"Acciones"),n()()(),i(12,"tbody"),f(13,pe,15,7,"tr",69),n()()()),c&2){let e=s(2);d(13),u("ngForOf",e.horarios)}}function he(c,t){if(c&1){let e=v();i(0,"button",74),p("click",function(){m(e);let o=s(2);return _(o.cancelarHorario())}),a(1,"Cancelar"),n()}}function fe(c,t){if(c&1){let e=v();E(0),i(1,"div",8)(2,"div",50)(3,"div")(4,"h4",36),a(5,"Horarios de: "),i(6,"span",51),a(7),n()(),i(8,"small",52),a(9),n()(),i(10,"button",13),p("click",function(){m(e);let o=s();return _(o.volverAListaMedicos())}),g(11,"i",53),a(12,"Volver a m\xE9dicos "),n()(),i(13,"div",9),f(14,_e,2,0,"div",17)(15,ue,6,0,"div",18)(16,ge,14,1,"div",19),n(),i(17,"div",54)(18,"h5",38),a(19),n(),i(20,"form",55,1),p("ngSubmit",function(){m(e);let o=s();return _(o.guardarHorario())}),i(22,"div",56)(23,"label",39),a(24,"Fecha"),n(),i(25,"input",57),M("ngModelChange",function(o){m(e);let l=s();return x(l.formHorario.fecha,o)||(l.formHorario.fecha=o),_(o)}),n()(),i(26,"div",58)(27,"label",39),a(28,"Hora"),n(),i(29,"input",59),M("ngModelChange",function(o){m(e);let l=s();return x(l.formHorario.hora,o)||(l.formHorario.hora=o),_(o)}),n()(),i(30,"div",60)(31,"div",61)(32,"input",62),M("ngModelChange",function(o){m(e);let l=s();return x(l.formHorario.disponible,o)||(l.formHorario.disponible=o),_(o)}),n(),i(33,"label",63),a(34,"Disponible"),n()()(),i(35,"div",64),f(36,he,2,0,"button",65),i(37,"button",66),a(38),n()()()()(),S()}if(c&2){let e=w(21),r=s();d(7),h(r.medicoActual==null?null:r.medicoActual.nombres),d(2),h(r.nombreDeEspecialidad((r.medicoActual==null?null:r.medicoActual.especialidad)||0)),d(5),u("ngIf",r.cargandoHorarios),d(),u("ngIf",!r.cargandoHorarios&&r.horarios.length===0),d(),u("ngIf",!r.cargandoHorarios&&r.horarios.length>0),d(3),h(r.modoHorario==="crear"?"A\xF1adir Nuevo Horario":"Editar Horario"),d(6),b("ngModel",r.formHorario.fecha),d(4),b("ngModel",r.formHorario.hora),d(3),b("ngModel",r.formHorario.disponible),d(4),u("ngIf",r.modoHorario==="editar"),d(),u("disabled",e.invalid),d(),y(" ",r.modoHorario==="crear"?"A\xF1adir":"Guardar"," ")}}var ee=class c{constructor(t,e,r){this.svc=t;this.espSvc=e;this.horSvc=r}medicos=[];especialidades=[];cargando=!0;mensaje="";busqueda="";vista="lista";modo="crear";formMedico=this.formMedicoPorDefecto();medicoActual=null;horarios=[];cargandoHorarios=!1;modoHorario="crear";formHorario=this.formHorarioPorDefecto();ngOnInit(){this.cargarEspecialidades(),this.cargarMedicos()}formMedicoPorDefecto(){return{id:null,nombres:"",correo:"",especialidad:null}}cargarEspecialidades(){this.espSvc.listar().subscribe({next:t=>this.especialidades=t,error:t=>console.error("Error cargando especialidades",t)})}cargarMedicos(){this.cargando=!0,this.svc.listar(this.busqueda).subscribe({next:t=>{this.medicos=t,this.cargando=!1},error:t=>{console.error("Error cargando m\xE9dicos:",t),this.mensaje="Error cargando m\xE9dicos",this.cargando=!1}})}nombreDeEspecialidad(t){let e=this.especialidades.find(r=>r.id===t);return e?e.nombre:`#${t}`}buscar(){this.cargarMedicos()}nuevoMedico(){this.modo="crear",this.formMedico=this.formMedicoPorDefecto(),this.vista="formMedico"}editarMedico(t){this.modo="editar",this.formMedico=P({},t),this.vista="formMedico"}cancelarMedico(){this.vista="lista",this.formMedico=this.formMedicoPorDefecto(),this.modo="crear"}guardarMedico(){this.modo==="crear"?this.svc.crear(this.formMedico).subscribe({next:()=>{this.mensaje="M\xE9dico creado.",this.cancelarMedico(),this.cargarMedicos()},error:t=>{console.error("Error creando m\xE9dico:",t),this.mensaje="Error creando m\xE9dico."}}):this.svc.actualizar(this.formMedico.id,this.formMedico).subscribe({next:()=>{this.mensaje="M\xE9dico actualizado.",this.cancelarMedico(),this.cargarMedicos()},error:t=>{console.error("Error actualizando m\xE9dico:",t),this.mensaje="Error actualizando m\xE9dico."}})}eliminarMedico(t){confirm(`\xBFEliminar al m\xE9dico "${t.nombres}"?`)&&this.svc.eliminar(t.id).subscribe({next:()=>{this.mensaje="M\xE9dico eliminado.",this.cargarMedicos()},error:e=>{console.error("Error eliminando m\xE9dico:",e),this.mensaje="Error eliminando m\xE9dico."}})}formHorarioPorDefecto(){return{id:null,fecha:"",hora:"",disponible:!0}}verHorarios(t){this.medicoActual=t,this.vista="horarios",this.cargarHorarios()}cargarHorarios(){this.medicoActual&&(this.cargandoHorarios=!0,this.horSvc.listar(this.medicoActual.id).subscribe({next:t=>{this.horarios=t,this.cargandoHorarios=!1},error:t=>{console.error("Error cargando horarios:",t),this.mensaje="Error cargando horarios.",this.cargandoHorarios=!1}}))}nuevoHorario(){this.modoHorario="crear",this.formHorario=this.formHorarioPorDefecto()}editarHorario(t){this.modoHorario="editar";let e=t.hora.slice(0,5);this.formHorario={id:t.id,fecha:t.fecha,hora:e,disponible:t.disponible}}cancelarHorario(){this.modoHorario="crear",this.formHorario=this.formHorarioPorDefecto()}guardarHorario(){this.medicoActual&&(this.modoHorario==="crear"?this.horSvc.crear(this.medicoActual.id,{fecha:this.formHorario.fecha,hora:this.formHorario.hora,disponible:this.formHorario.disponible}).subscribe({next:()=>{this.mensaje="Horario creado.",this.cancelarHorario(),this.cargarHorarios()},error:t=>{console.error("Error creando horario:",t),this.mensaje="Error creando horario."}}):this.horSvc.actualizar(this.formHorario.id,{fecha:this.formHorario.fecha,hora:this.formHorario.hora,disponible:this.formHorario.disponible}).subscribe({next:()=>{this.mensaje="Horario actualizado.",this.cancelarHorario(),this.cargarHorarios()},error:t=>{console.error("Error actualizando horario:",t),this.mensaje="Error actualizando horario."}}))}eliminarHorario(t){confirm(`\xBFEliminar el horario ${t.fecha} ${t.hora}?`)&&this.horSvc.eliminar(t.id).subscribe({next:()=>{this.mensaje="Horario eliminado.",this.cargarHorarios()},error:e=>{console.error("Error eliminando horario:",e),this.mensaje="Error eliminando horario."}})}volverAListaMedicos(){this.vista="lista",this.medicoActual=null,this.cancelarHorario()}static \u0275fac=function(e){return new(e||c)(C(Z),C(Y),C(H))};static \u0275cmp=k({type:c,selectors:[["app-panel-admin-medicos"]],decls:9,vars:4,consts:[["medForm","ngForm"],["horForm","ngForm"],[1,"container","mt-4","admin-medicos-page"],[1,"page-header"],[1,"bi","bi-person-badge-fill","page-icon"],["class","alert alert-info",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-info"],[1,"card","shadow-sm"],[1,"card-body"],[1,"toolbar"],[1,"input-group","search-bar"],["type","text","placeholder","Buscar por nombre o correo...",1,"form-control",3,"ngModelChange","keyup.enter","ngModel"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"bi","bi-search"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-plus-lg","me-2"],["class","loading-state",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"loading-state"],["role","status",1,"spinner-border","text-primary"],[1,"mt-2"],[1,"empty-state"],[1,"bi","bi-person-x-fill","empty-icon"],[1,"table-responsive"],[1,"table","custom-table","align-middle"],[1,"text-end"],[4,"ngFor","ngForOf"],["title","Ver Horarios",1,"btn","btn-sm","btn-outline-secondary","me-2",3,"click"],[1,"bi","bi-clock-history","me-1"],["title","Editar M\xE9dico",1,"btn","btn-sm","btn-outline-primary","me-2",3,"click"],[1,"bi","bi-pencil-fill","me-1"],["title","Eliminar M\xE9dico",1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"bi","bi-trash-fill","me-1"],[1,"card-header"],[1,"mb-0"],[3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["name","nombres","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","correo","type","email","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","especialidad","required","",1,"form-select",3,"ngModelChange","ngModel"],["disabled","",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"card-footer","form-actions"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-success",3,"click","disabled"],[1,"bi","bi-check-lg","me-2"],[3,"ngValue"],[1,"card-header","d-flex","justify-content-between","align-items-center","horarios-header"],[1,"text-primary"],[1,"text-muted"],[1,"bi","bi-arrow-left","me-2"],[1,"card-footer","horarios-form-section"],[1,"row","g-3","align-items-end",3,"ngSubmit"],[1,"col-md-4"],["type","date","name","fecha","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-3"],["type","time","name","hora","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-2"],[1,"form-check"],["type","checkbox","id","dispChk","name","disponible",1,"form-check-input",3,"ngModelChange","ngModel"],["for","dispChk",1,"form-check-label"],[1,"col-md-3","text-end"],["class","btn btn-secondary btn-sm me-2","type","button",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-success","btn-sm",3,"disabled"],[1,"bi","bi-clock-fill","empty-icon"],[1,"table","custom-table","table-sm","align-middle"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"badge",3,"ngClass"],[1,"btn","btn-sm","btn-outline-primary","me-2",3,"click"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],["type","button",1,"btn","btn-secondary","btn-sm","me-2",3,"click"]],template:function(e,r){e&1&&(i(0,"div",2)(1,"header",3),g(2,"i",4),i(3,"h2"),a(4,"Administrar M\xE9dicos"),n()(),f(5,re,2,1,"div",5)(6,le,14,4,"ng-container",6)(7,me,29,8,"ng-container",6)(8,fe,39,12,"ng-container",6),n()),e&2&&(d(5),u("ngIf",r.mensaje),d(),u("ngIf",r.vista==="lista"),d(),u("ngIf",r.vista==="formMedico"),d(),u("ngIf",r.vista==="horarios"))},dependencies:[j,I,T,F,Q,U,R,J,z,D,G,q,B,K,$,L],styles:[".page-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem}.page-icon[_ngcontent-%COMP%]{font-size:2.5rem;color:#0d6efd}.page-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-weight:700;color:#2c3e50}.card[_ngcontent-%COMP%]{border:none;border-radius:12px}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #e9ecef;font-weight:600}.card-footer[_ngcontent-%COMP%]{background-color:#f8f9fa;border-top:1px solid #e9ecef}.toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;flex-wrap:wrap;gap:1rem}.search-bar[_ngcontent-%COMP%]{max-width:350px}.custom-table[_ngcontent-%COMP%]{border-collapse:separate;border-spacing:0}.custom-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;color:#5a6a7a;border-bottom-width:2px}.custom-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .2s ease-in-out}.custom-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.custom-table[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-weight:600;padding:.4em .8em;font-size:.8rem}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;padding:1rem 1.25rem}.loading-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem;color:#6c757d}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem;color:#ced4da}.horarios-header[_ngcontent-%COMP%]{background-color:#e9ecef}.horarios-form-section[_ngcontent-%COMP%]{background-color:#f8f9fa}"]})};export{ee as PanelAdminMedicos};

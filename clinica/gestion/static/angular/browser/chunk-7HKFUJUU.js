import{$a as x,Aa as _,Cb as I,Db as V,Eb as T,Hb as O,Jb as W,Kb as F,La as d,Lb as N,Ma as a,Na as o,Nb as j,Pa as u,Qa as S,Ra as p,V as m,Va as P,W as g,Wa as l,Xa as f,_a as h,ab as v,na as c,ra as C,rb as E,sb as b,tb as M,xa as y,zb as w}from"./chunk-4U6L5S5K.js";function H(i,n){if(i&1&&(a(0,"option",10),l(1),o()),i&2){let e=n.$implicit;d("value",e.id),c(),f(e.nombre)}}function B(i,n){if(i&1&&(a(0,"option",10),l(1),o()),i&2){let e=n.$implicit;d("value",e.id),c(),f(e.nombres)}}function D(i,n){if(i&1){let e=u();a(0,"div",2)(1,"label",3),l(2,"M\xE9dico"),o(),a(3,"select",11),v("ngModelChange",function(r){m(e);let s=p();return x(s.medicoSeleccionado,r)||(s.medicoSeleccionado=r),g(r)}),a(4,"option",5),l(5,"-- Seleccione --"),o(),_(6,B,2,2,"option",6),o()()}if(i&2){let e=p();c(3),h("ngModel",e.medicoSeleccionado),c(3),d("ngForOf",e.medicos)}}function L(i,n){if(i&1){let e=u();a(0,"div",2)(1,"label",3),l(2,"Fecha"),o(),a(3,"input",12),v("ngModelChange",function(r){m(e);let s=p();return x(s.fecha,r)||(s.fecha=r),g(r)}),o()()}if(i&2){let e=p();c(3),h("ngModel",e.fecha)}}function A(i,n){if(i&1){let e=u();a(0,"div",2)(1,"label",3),l(2,"Hora"),o(),a(3,"input",13),v("ngModelChange",function(r){m(e);let s=p();return x(s.hora,r)||(s.hora=r),g(r)}),o()()}if(i&2){let e=p();c(3),h("ngModel",e.hora)}}function R(i,n){if(i&1){let e=u();a(0,"button",14),S("click",function(){m(e);let r=p();return g(r.reservarCita())}),l(1,"Reservar"),o()}}var k=class i{constructor(n){this.http=n}especialidades=[];medicos=[];especialidadSeleccionada="";medicoSeleccionado="";fecha="";hora="";mensaje="";exito=!1;ngOnInit(){this.cargarEspecialidades()}cargarEspecialidades(){this.http.get("/api/especialidades/").subscribe({next:n=>this.especialidades=n,error:n=>console.error("Error cargando especialidades:",n)})}onEspecialidadChange(n){let e=n.target.value;this.especialidadSeleccionada=e,this.medicoSeleccionado="",this.medicos=[],e&&this.http.get(`/api/medicos/?especialidad=${e}`).subscribe({next:t=>this.medicos=t,error:t=>console.error("Error cargando m\xE9dicos:",t)})}reservarCita(){if(!this.medicoSeleccionado||!this.fecha||!this.hora){this.mensaje="Complete todos los campos.",this.exito=!1;return}let n={medico:this.medicoSeleccionado,fecha:this.fecha,hora:this.hora},e=localStorage.getItem("token")||"";this.http.post("/api/citas/reservar/",n,{headers:{Authorization:`Bearer ${e}`}}).subscribe({next:t=>{this.mensaje=t.message||"Cita reservada con \xE9xito.",this.exito=!0},error:t=>{console.error("Error reservar cita:",t),this.mensaje=t?.error?.error||"Error al reservar la cita.",this.exito=!1}})}static \u0275fac=function(e){return new(e||i)(C(w))};static \u0275cmp=y({type:i,selectors:[["app-panel-paciente"]],decls:18,vars:10,consts:[[1,"container","mt-4"],[1,"text-primary"],[1,"mb-3"],[1,"form-label"],[1,"form-select",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","mb-3",4,"ngIf"],["class","btn btn-success",3,"click",4,"ngIf"],[1,"mt-3"],[3,"value"],[1,"form-select",3,"ngModelChange","ngModel"],["type","date",1,"form-control",3,"ngModelChange","ngModel"],["type","time",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-success",3,"click"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"h2",1),l(2,"Reservar Cita"),o(),a(3,"p"),l(4,"Seleccione una especialidad, luego un m\xE9dico, y elija fecha y hora."),o(),a(5,"div",2)(6,"label",3),l(7,"Especialidad"),o(),a(8,"select",4),S("change",function(s){return t.onEspecialidadChange(s)}),a(9,"option",5),l(10,"-- Seleccione --"),o(),_(11,H,2,2,"option",6),o()(),_(12,D,7,2,"div",7)(13,L,4,1,"div",7)(14,A,4,1,"div",7)(15,R,2,0,"button",8),a(16,"p",9),l(17),o()()),e&2&&(c(11),d("ngForOf",t.especialidades),c(),d("ngIf",t.medicos.length>0),c(),d("ngIf",t.medicoSeleccionado),c(),d("ngIf",t.medicoSeleccionado),c(),d("ngIf",t.medicoSeleccionado),c(),P("text-success",t.exito)("text-danger",!t.exito),c(),f(t.mensaje))},dependencies:[M,E,b,j,F,N,V,W,T,O,I],encapsulation:2})};export{k as PanelPaciente};

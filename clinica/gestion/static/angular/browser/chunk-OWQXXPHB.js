import{a as V,b as A,c as T,d as W,e as I,f as F,k as N}from"./chunk-GWID5FSU.js";import{$a as x,Ab as v,Da as h,Hb as M,Oa as S,Pa as i,Qa as n,Sa as b,Ta as _,Ua as c,X as m,Y as p,_a as a,a as C,cb as u,db as g,eb as f,pa as l,ta as w,yb as E,za as y,zb as P}from"./chunk-ACDHHO7I.js";function L(s,r){if(s&1){let e=b();i(0,"tr")(1,"td"),a(2),n(),i(3,"td"),a(4),n(),i(5,"td"),a(6),n(),i(7,"td"),a(8),n(),i(9,"td")(10,"button",7),_("click",function(){let t=m(e).$implicit,o=c(2);return p(o.editarPaciente(t))}),a(11,"Editar"),n(),i(12,"button",8),_("click",function(){let t=m(e).$implicit,o=c(2);return p(o.eliminarPaciente(t.id))}),a(13,"Eliminar"),n()()()}if(s&2){let e=r.$implicit;l(2),x(e.nombres),l(2),x(e.apellidos),l(2),x(e.telefono),l(2),x(e.usuario.email)}}function B(s,r){if(s&1){let e=b();i(0,"div")(1,"div",1)(2,"input",3),f("ngModelChange",function(t){m(e);let o=c();return g(o.filtro,t)||(o.filtro=t),p(t)}),_("input",function(){m(e);let t=c();return p(t.filtrarPacientes())}),n()(),i(3,"table",4)(4,"thead",5)(5,"tr")(6,"th"),a(7,"Nombre"),n(),i(8,"th"),a(9,"Apellido"),n(),i(10,"th"),a(11,"Tel\xE9fono"),n(),i(12,"th"),a(13,"Email"),n(),i(14,"th"),a(15,"Acciones"),n()()(),i(16,"tbody"),h(17,L,14,4,"tr",6),n()()()}if(s&2){let e=c();l(2),u("ngModel",e.filtro),l(15),S("ngForOf",e.pacientesFiltrados)}}function O(s,r){if(s&1){let e=b();i(0,"div")(1,"h3"),a(2,"Editar Paciente"),n(),i(3,"form",9),_("ngSubmit",function(){m(e);let t=c();return p(t.guardarEdicion())}),i(4,"div",1)(5,"label",10),a(6,"Nombres"),n(),i(7,"input",11),f("ngModelChange",function(t){m(e);let o=c();return g(o.pacienteSeleccionado.nombres,t)||(o.pacienteSeleccionado.nombres=t),p(t)}),n()(),i(8,"div",1)(9,"label",10),a(10,"Apellidos"),n(),i(11,"input",12),f("ngModelChange",function(t){m(e);let o=c();return g(o.pacienteSeleccionado.apellidos,t)||(o.pacienteSeleccionado.apellidos=t),p(t)}),n()(),i(12,"div",1)(13,"label",10),a(14,"Tel\xE9fono"),n(),i(15,"input",13),f("ngModelChange",function(t){m(e);let o=c();return g(o.pacienteSeleccionado.telefono,t)||(o.pacienteSeleccionado.telefono=t),p(t)}),n()(),i(16,"div",1)(17,"label",10),a(18,"Correo"),n(),i(19,"input",14),f("ngModelChange",function(t){m(e);let o=c();return g(o.pacienteSeleccionado.usuario.email,t)||(o.pacienteSeleccionado.usuario.email=t),p(t)}),n()(),i(20,"button",15),a(21,"Guardar"),n(),i(22,"button",16),_("click",function(){m(e);let t=c();return p(t.cancelarEdicion())}),a(23,"Cancelar"),n()()()}if(s&2){let e=c();l(7),u("ngModel",e.pacienteSeleccionado.nombres),l(4),u("ngModel",e.pacienteSeleccionado.apellidos),l(4),u("ngModel",e.pacienteSeleccionado.telefono),l(4),u("ngModel",e.pacienteSeleccionado.usuario.email)}}var k=class s{constructor(r){this.http=r}pacientes=[];pacientesFiltrados=[];filtro="";editando=!1;pacienteSeleccionado=null;ngOnInit(){this.cargarPacientes()}cargarPacientes(){this.http.get("/api/admin/pacientes/").subscribe(r=>{this.pacientes=r,this.pacientesFiltrados=r})}filtrarPacientes(){let r=this.filtro.toLowerCase();this.pacientesFiltrados=this.pacientes.filter(e=>`${e.nombres} ${e.apellidos}`.toLowerCase().includes(r))}editarPaciente(r){this.pacienteSeleccionado=C({},r),this.editando=!0}cancelarEdicion(){this.editando=!1,this.pacienteSeleccionado=null}guardarEdicion(){this.http.put(`/api/admin/pacientes/${this.pacienteSeleccionado.id}/`,this.pacienteSeleccionado).subscribe({next:()=>{this.cargarPacientes(),this.editando=!1,this.pacienteSeleccionado=null},error:r=>console.error("Error al editar paciente",r)})}eliminarPaciente(r){confirm("\xBFSeguro que deseas eliminar este paciente?")&&this.http.delete(`/api/admin/pacientes/${r}/`).subscribe({next:()=>this.cargarPacientes(),error:e=>console.error("Error al eliminar paciente",e)})}static \u0275fac=function(e){return new(e||s)(w(M))};static \u0275cmp=y({type:s,selectors:[["app-panel-admin"]],decls:5,vars:2,consts:[[1,"container","mt-4"],[1,"mb-3"],[4,"ngIf"],["type","text","placeholder","Buscar por nombre...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"table","table-bordered","table-hover"],[1,"table-primary"],[4,"ngFor","ngForOf"],[1,"btn","btn-warning","btn-sm",3,"click"],[1,"btn","btn-danger","btn-sm",3,"click"],[3,"ngSubmit"],[1,"form-label"],["type","text","name","nombres",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","apellidos",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","telefono",1,"form-control",3,"ngModelChange","ngModel"],["type","email","name","email",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-success"],["type","button",1,"btn","btn-secondary","ms-2",3,"click"]],template:function(e,d){e&1&&(i(0,"div",0)(1,"h2",1),a(2,"Gesti\xF3n de Pacientes"),n(),h(3,B,18,2,"div",2)(4,O,24,4,"div",2),n()),e&2&&(l(3),S("ngIf",!d.editando),l(),S("ngIf",d.editando))},dependencies:[v,E,P,N,F,V,A,T,I,W],encapsulation:2})};export{k as PanelAdmin};

import{a as F,b as B,c as U,d as H,e as q,f as L,j as z,k as O}from"./chunk-GWID5FSU.js";import{$a as v,Ab as j,Da as P,Hb as N,N as E,Oa as u,Pa as t,Qa as n,R as A,Ra as I,Sa as w,Ta as b,Ua as g,X as c,Y as p,_a as o,a as S,ab as V,b as C,bb as T,cb as f,db as _,eb as h,pa as s,ta as x,yb as W,za as M,zb as k}from"./chunk-ACDHHO7I.js";var y=class r{constructor(e){this.http=e}baseUrl="/api/admin/pacientes/";authHeaders(){return{Authorization:`Bearer ${localStorage.getItem("token")||""}`}}listar(e=""){let a=e?`${this.baseUrl}?q=${encodeURIComponent(e)}`:this.baseUrl;return this.http.get(a,{headers:this.authHeaders()})}crear(e){return this.http.post(this.baseUrl,e,{headers:this.authHeaders()})}obtener(e){return this.http.get(`${this.baseUrl}${e}/`,{headers:this.authHeaders()})}actualizar(e,a){return this.http.patch(`${this.baseUrl}${e}/`,a,{headers:this.authHeaders()})}eliminar(e){return this.http.delete(`${this.baseUrl}${e}/`,{headers:this.authHeaders()})}static \u0275fac=function(a){return new(a||r)(A(N))};static \u0275prov=E({token:r,factory:r.\u0275fac,providedIn:"root"})};function J(r,e){if(r&1&&(t(0,"div",24),o(1),n()),r&2){let a=g();s(),v(a.mensaje)}}function K(r,e){r&1&&(t(0,"div"),o(1,"Cargando pacientes..."),n())}function Q(r,e){r&1&&(t(0,"div",25),o(1," No se encontraron pacientes. "),n())}function X(r,e){if(r&1){let a=w();t(0,"tr")(1,"td"),o(2),n(),t(3,"td"),o(4),n(),t(5,"td"),o(6),n(),t(7,"td"),o(8),n(),t(9,"td")(10,"button",30),b("click",function(){let m=c(a).$implicit,d=g(2);return p(d.editarPaciente(m))}),o(11,"Editar"),n(),t(12,"button",31),b("click",function(){let m=c(a).$implicit,d=g(2);return p(d.eliminarPaciente(m))}),o(13,"Eliminar"),n()()()}if(r&2){let a=e.$implicit;s(2),v(a.username),s(2),T("",a.first_name," ",a.last_name),s(2),v(a.email),s(2),v(a.telefono)}}function Y(r,e){if(r&1&&(t(0,"div",26)(1,"table",27)(2,"thead")(3,"tr")(4,"th"),o(5,"Usuario"),n(),t(6,"th"),o(7,"Nombre"),n(),t(8,"th"),o(9,"Correo"),n(),t(10,"th"),o(11,"Tel\xE9fono"),n(),t(12,"th",28),o(13,"Acciones"),n()()(),t(14,"tbody"),P(15,X,14,5,"tr",29),n()()()),r&2){let a=g();s(15),u("ngForOf",a.pacientes)}}function Z(r,e){r&1&&(t(0,"h4"),o(1,"A\xF1adir Paciente"),n())}function $(r,e){r&1&&(t(0,"h4"),o(1,"Editar Paciente"),n())}function ee(r,e){if(r&1){let a=w();t(0,"div",12)(1,"label",13),o(2,"Contrase\xF1a"),n(),t(3,"input",32),h("ngModelChange",function(m){c(a);let d=g();return _(d.formPaciente.password,m)||(d.formPaciente.password=m),p(m)}),n()()}if(r&2){let a=g();s(3),f("ngModel",a.formPaciente.password)}}function te(r,e){if(r&1){let a=w();t(0,"button",33),b("click",function(){c(a);let m=g();return p(m.nuevoPaciente())}),o(1," Cancelar "),n()}}var D=class r{constructor(e){this.svc=e}pacientes=[];cargando=!0;mensaje="";busqueda="";modo="crear";formPaciente={id:null,username:"",email:"",first_name:"",last_name:"",telefono:"",password:""};ngOnInit(){this.cargarPacientes()}cargarPacientes(){this.cargando=!0,this.svc.listar(this.busqueda).subscribe({next:e=>{this.pacientes=e,this.cargando=!1},error:e=>{console.error("Error cargando pacientes:",e),this.mensaje="Error cargando pacientes",this.cargando=!1}})}buscar(){this.cargarPacientes()}nuevoPaciente(){this.modo="crear",this.formPaciente={id:null,username:"",email:"",first_name:"",last_name:"",telefono:"",password:""}}editarPaciente(e){this.modo="editar",this.formPaciente=C(S({},e),{password:""})}guardarPaciente(){this.modo==="crear"?this.svc.crear(this.formPaciente).subscribe({next:()=>{this.mensaje="Paciente creado.",this.nuevoPaciente(),this.cargarPacientes()},error:e=>{console.error("Error creando paciente:",e),this.mensaje="Error creando paciente."}}):this.svc.actualizar(this.formPaciente.id,this.formPaciente).subscribe({next:()=>{this.mensaje="Paciente actualizado.",this.nuevoPaciente(),this.cargarPacientes()},error:e=>{console.error("Error actualizando paciente:",e),this.mensaje="Error actualizando paciente."}})}eliminarPaciente(e){confirm(`\xBFEliminar al paciente "${e.username}"?`)&&this.svc.eliminar(e.id).subscribe({next:()=>{this.mensaje="Paciente eliminado.",this.cargarPacientes()},error:a=>{console.error("Error eliminando paciente:",a),this.mensaje="Error eliminando paciente."}})}static \u0275fac=function(a){return new(a||r)(x(y))};static \u0275cmp=M({type:r,selectors:[["app-panel-admin"]],decls:41,vars:15,consts:[["pacForm","ngForm"],[1,"container","mt-4"],[1,"text-danger","mb-4"],["class","alert alert-info",4,"ngIf"],[1,"input-group","mb-3"],["type","text","placeholder","Buscar paciente...",1,"form-control",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[4,"ngIf"],["class","alert alert-warning",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"my-4"],[3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["name","username","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","email","type","email",1,"form-control",3,"ngModelChange","ngModel"],[1,"row"],[1,"col-md-6","mb-3"],["name","first_name",1,"form-control",3,"ngModelChange","ngModel"],["name","last_name",1,"form-control",3,"ngModelChange","ngModel"],["name","telefono",1,"form-control",3,"ngModelChange","ngModel"],["class","mb-3",4,"ngIf"],["type","submit",1,"btn","btn-success"],["class","btn btn-secondary ms-2","type","button",3,"click",4,"ngIf"],[1,"alert","alert-info"],[1,"alert","alert-warning"],[1,"table-responsive"],[1,"table","table-striped","align-middle"],[2,"width","130px"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-primary","me-1",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],["name","password","type","password",1,"form-control",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-secondary","ms-2",3,"click"]],template:function(a,i){if(a&1){let m=w();t(0,"div",1)(1,"h2",2),o(2,"Panel de Administrador"),n(),P(3,J,2,1,"div",3),t(4,"div",4)(5,"input",5),h("ngModelChange",function(l){return c(m),_(i.busqueda,l)||(i.busqueda=l),p(l)}),n(),t(6,"button",6),b("click",function(){return c(m),p(i.buscar())}),o(7,"Buscar"),n()(),P(8,K,2,0,"div",7)(9,Q,2,0,"div",8)(10,Y,16,1,"div",9),I(11,"hr",10),P(12,Z,2,0,"h4",7)(13,$,2,0,"h4",7),t(14,"form",11,0),b("ngSubmit",function(){return c(m),p(i.guardarPaciente())}),t(16,"div",12)(17,"label",13),o(18,"Usuario"),n(),t(19,"input",14),h("ngModelChange",function(l){return c(m),_(i.formPaciente.username,l)||(i.formPaciente.username=l),p(l)}),n()(),t(20,"div",12)(21,"label",13),o(22,"Correo"),n(),t(23,"input",15),h("ngModelChange",function(l){return c(m),_(i.formPaciente.email,l)||(i.formPaciente.email=l),p(l)}),n()(),t(24,"div",16)(25,"div",17)(26,"label",13),o(27,"Nombres"),n(),t(28,"input",18),h("ngModelChange",function(l){return c(m),_(i.formPaciente.first_name,l)||(i.formPaciente.first_name=l),p(l)}),n()(),t(29,"div",17)(30,"label",13),o(31,"Apellidos"),n(),t(32,"input",19),h("ngModelChange",function(l){return c(m),_(i.formPaciente.last_name,l)||(i.formPaciente.last_name=l),p(l)}),n()()(),t(33,"div",12)(34,"label",13),o(35,"Tel\xE9fono"),n(),t(36,"input",20),h("ngModelChange",function(l){return c(m),_(i.formPaciente.telefono,l)||(i.formPaciente.telefono=l),p(l)}),n()(),P(37,ee,4,1,"div",21),t(38,"button",22),o(39),n(),P(40,te,2,0,"button",23),n()()}a&2&&(s(3),u("ngIf",i.mensaje),s(2),f("ngModel",i.busqueda),s(3),u("ngIf",i.cargando),s(),u("ngIf",!i.cargando&&i.pacientes.length===0),s(),u("ngIf",!i.cargando&&i.pacientes.length>0),s(2),u("ngIf",i.modo==="crear"),s(),u("ngIf",i.modo==="editar"),s(6),f("ngModel",i.formPaciente.username),s(4),f("ngModel",i.formPaciente.email),s(5),f("ngModel",i.formPaciente.first_name),s(4),f("ngModel",i.formPaciente.last_name),s(4),f("ngModel",i.formPaciente.telefono),s(),u("ngIf",i.modo==="crear"),s(2),V(" ",i.modo==="crear"?"Crear Paciente":"Guardar Cambios"," "),s(),u("ngIf",i.modo==="editar"))},dependencies:[j,W,k,O,L,F,B,U,z,q,H],encapsulation:2})};export{D as PanelAdmin};

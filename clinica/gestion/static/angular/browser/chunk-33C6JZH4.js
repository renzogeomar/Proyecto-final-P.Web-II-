import{b as R}from"./chunk-HRWH4WAD.js";import{a as O,b as H,c as W,d as D,e as q,f as B,g as z,h as U,i as L,j as $,k as G}from"./chunk-NTTMCPIT.js";import{Ab as I,Bb as F,Cb as T,Da as g,Ib as k,Jb as j,Kb as N,N as w,Oa as m,Pa as n,Qa as r,R as A,Sa as S,Ta as C,Ua as x,Va as _,Wa as s,X as p,Y as u,a as y,ab as a,bb as f,cb as V,eb as b,fb as M,gb as h,pa as c,ta as E,za as P}from"./chunk-HFRQGZMK.js";var v=class i{constructor(t){this.http=t}baseUrl="/api/admin/medicos/";authHeaders(){let t=localStorage.getItem("token")||"";return new k({Authorization:`Bearer ${t}`})}listar(t=""){let e=new j;return t&&(e=e.set("q",t)),this.http.get(this.baseUrl,{headers:this.authHeaders(),params:e})}crear(t){return this.http.post(this.baseUrl,t,{headers:this.authHeaders()})}actualizar(t,e){return this.http.put(`${this.baseUrl}${t}/`,e,{headers:this.authHeaders()})}eliminar(t){return this.http.delete(`${this.baseUrl}${t}/`,{headers:this.authHeaders()})}static \u0275fac=function(e){return new(e||i)(A(N))};static \u0275prov=w({token:i,factory:i.\u0275fac,providedIn:"root"})};function X(i,t){if(i&1&&(n(0,"div",5),a(1),r()),i&2){let e=s();c(),f(e.mensaje)}}function Y(i,t){i&1&&(n(0,"div"),a(1,"Cargando m\xE9dicos..."),r())}function Z(i,t){i&1&&(n(0,"div",15),a(1," No se encontraron m\xE9dicos. "),r())}function ee(i,t){if(i&1){let e=x();n(0,"tr")(1,"td"),a(2),r(),n(3,"td"),a(4),r(),n(5,"td"),a(6),r(),n(7,"td")(8,"button",20),_("click",function(){let o=p(e).$implicit,l=s(3);return u(l.editarMedico(o))}),a(9,"Editar"),r(),n(10,"button",21),_("click",function(){let o=p(e).$implicit,l=s(3);return u(l.eliminarMedico(o))}),a(11,"Eliminar"),r()()()}if(i&2){let e=t.$implicit,d=s(3);c(2),f(e.nombres),c(2),f(e.correo),c(2),f(d.nombreDeEspecialidad(e.especialidad))}}function te(i,t){if(i&1&&(n(0,"div",16)(1,"table",17)(2,"thead")(3,"tr")(4,"th"),a(5,"Nombre"),r(),n(6,"th"),a(7,"Correo"),r(),n(8,"th"),a(9,"Especialidad"),r(),n(10,"th",18),a(11,"Acciones"),r()()(),n(12,"tbody"),g(13,ee,12,3,"tr",19),r()()()),i&2){let e=s(2);c(13),m("ngForOf",e.medicos)}}function ie(i,t){if(i&1){let e=x();S(0),n(1,"div",6)(2,"div",7)(3,"div",8)(4,"input",9),h("ngModelChange",function(o){p(e);let l=s();return M(l.busqueda,o)||(l.busqueda=o),u(o)}),_("keyup.enter",function(){p(e);let o=s();return u(o.buscar())}),r(),n(5,"button",10),_("click",function(){p(e);let o=s();return u(o.buscar())}),a(6,"Buscar"),r()()(),n(7,"div",11)(8,"button",12),_("click",function(){p(e);let o=s();return u(o.nuevoMedico())}),a(9,"A\xF1adir M\xE9dico"),r()()(),g(10,Y,2,0,"div",4)(11,Z,2,0,"div",13)(12,te,14,1,"div",14),C()}if(i&2){let e=s();c(4),b("ngModel",e.busqueda),c(6),m("ngIf",e.cargando),c(),m("ngIf",!e.cargando&&e.medicos.length===0),c(),m("ngIf",!e.cargando&&e.medicos.length>0)}}function ne(i,t){i&1&&(n(0,"h4"),a(1,"A\xF1adir M\xE9dico"),r())}function re(i,t){i&1&&(n(0,"h4"),a(1,"Editar M\xE9dico"),r())}function oe(i,t){if(i&1&&(n(0,"option",32),a(1),r()),i&2){let e=t.$implicit;m("ngValue",e.id),c(),f(e.nombre)}}function ae(i,t){if(i&1){let e=x();S(0),g(1,ne,2,0,"h4",4)(2,re,2,0,"h4",4),n(3,"form",22,0),_("ngSubmit",function(){p(e);let o=s();return u(o.guardarMedico())}),n(5,"div",23)(6,"label",24),a(7,"Nombres"),r(),n(8,"input",25),h("ngModelChange",function(o){p(e);let l=s();return M(l.formMedico.nombres,o)||(l.formMedico.nombres=o),u(o)}),r()(),n(9,"div",23)(10,"label",24),a(11,"Correo"),r(),n(12,"input",26),h("ngModelChange",function(o){p(e);let l=s();return M(l.formMedico.correo,o)||(l.formMedico.correo=o),u(o)}),r()(),n(13,"div",23)(14,"label",24),a(15,"Especialidad"),r(),n(16,"select",27),h("ngModelChange",function(o){p(e);let l=s();return M(l.formMedico.especialidad,o)||(l.formMedico.especialidad=o),u(o)}),n(17,"option",28),a(18,"--Seleccione--"),r(),g(19,oe,2,2,"option",29),r()(),n(20,"button",30),a(21),r(),n(22,"button",31),_("click",function(){p(e);let o=s();return u(o.cancelarFormulario())}),a(23,"Cancelar"),r()(),C()}if(i&2){let e=s();c(),m("ngIf",e.modo==="crear"),c(),m("ngIf",e.modo==="editar"),c(6),b("ngModel",e.formMedico.nombres),c(4),b("ngModel",e.formMedico.correo),c(4),b("ngModel",e.formMedico.especialidad),c(),m("ngValue",null),c(2),m("ngForOf",e.especialidades),c(2),V(" ",e.modo==="crear"?"Crear M\xE9dico":"Guardar Cambios"," ")}}var J=class i{constructor(t,e){this.svc=t;this.espSvc=e}medicos=[];especialidades=[];cargando=!0;mensaje="";busqueda="";mostrandoFormulario=!1;modo="crear";formMedico=this.formPorDefecto();ngOnInit(){this.cargarEspecialidades(),this.cargarMedicos()}formPorDefecto(){return{id:null,nombres:"",correo:"",especialidad:null}}cargarEspecialidades(){this.espSvc.listar().subscribe({next:t=>this.especialidades=t,error:t=>console.error("Error cargando especialidades",t)})}cargarMedicos(){this.cargando=!0,this.svc.listar(this.busqueda).subscribe({next:t=>{this.medicos=t,this.cargando=!1},error:t=>{console.error("Error cargando m\xE9dicos:",t),this.mensaje="Error cargando m\xE9dicos",this.cargando=!1}})}nombreDeEspecialidad(t){let e=this.especialidades.find(d=>d.id===t);return e?e.nombre:`#${t}`}buscar(){this.cargarMedicos()}nuevoMedico(){this.modo="crear",this.formMedico=this.formPorDefecto(),this.mostrandoFormulario=!0}editarMedico(t){this.modo="editar",this.formMedico=y({},t),this.mostrandoFormulario=!0}cancelarFormulario(){this.mostrandoFormulario=!1,this.formMedico=this.formPorDefecto(),this.modo="crear"}guardarMedico(){this.modo==="crear"?this.svc.crear(this.formMedico).subscribe({next:()=>{this.mensaje="M\xE9dico creado.",this.cancelarFormulario(),this.cargarMedicos()},error:t=>{console.error("Error creando m\xE9dico:",t),this.mensaje="Error creando m\xE9dico."}}):this.svc.actualizar(this.formMedico.id,this.formMedico).subscribe({next:()=>{this.mensaje="M\xE9dico actualizado.",this.cancelarFormulario(),this.cargarMedicos()},error:t=>{console.error("Error actualizando m\xE9dico:",t),this.mensaje="Error actualizando m\xE9dico."}})}eliminarMedico(t){confirm(`\xBFEliminar al m\xE9dico "${t.nombres}"?`)&&this.svc.eliminar(t.id).subscribe({next:()=>{this.mensaje="M\xE9dico eliminado.",this.cargarMedicos()},error:e=>{console.error("Error eliminando m\xE9dico:",e),this.mensaje="Error eliminando m\xE9dico."}})}static \u0275fac=function(e){return new(e||i)(E(v),E(R))};static \u0275cmp=P({type:i,selectors:[["app-panel-admin-medicos"]],decls:6,vars:3,consts:[["medForm","ngForm"],[1,"container","mt-4"],[1,"text-danger","mb-4"],["class","alert alert-info",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-info"],[1,"row","mb-3","g-2","align-items-center"],[1,"col-sm"],[1,"input-group"],["type","text","placeholder","Buscar m\xE9dico...",1,"form-control",3,"ngModelChange","keyup.enter","ngModel"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"col-auto"],["type","button",1,"btn","btn-success",3,"click"],["class","alert alert-warning",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"alert","alert-warning"],[1,"table-responsive"],[1,"table","table-striped","align-middle"],[2,"width","130px"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-primary","me-1",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"mt-3",3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["name","nombres","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","correo","type","email","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","especialidad","required","",1,"form-select",3,"ngModelChange","ngModel"],["disabled","",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-success"],["type","button",1,"btn","btn-secondary","ms-2",3,"click"],[3,"ngValue"]],template:function(e,d){e&1&&(n(0,"div",1)(1,"h2",2),a(2,"Administrar M\xE9dicos"),r(),g(3,X,2,1,"div",3)(4,ie,13,4,"ng-container",4)(5,ae,24,8,"ng-container",4),r()),e&2&&(c(3),m("ngIf",d.mensaje),c(),m("ngIf",!d.mostrandoFormulario),c(),m("ngIf",d.mostrandoFormulario))},dependencies:[T,I,F,G,B,U,L,O,z,H,W,$,q,D],encapsulation:2})};export{J as PanelAdminMedicos};

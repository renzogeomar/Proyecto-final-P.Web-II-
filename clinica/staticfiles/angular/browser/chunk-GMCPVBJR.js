import{a as L}from"./chunk-RSWXCVJO.js";import{b as F,c as W,d as k,e as N,f as j,g as B,k as D,l as q}from"./chunk-D74MC6KC.js";import{Cb as V,Da as P,Db as T,Eb as I,Oa as u,Pa as n,Qa as i,Sa as w,Ta as C,Ua as h,Va as p,Wa as m,X as d,Y as _,a as v,ab as a,b as y,bb as b,cb as A,db as M,fb as g,gb as f,hb as x,pa as c,ta as S,za as E}from"./chunk-MSDOTIZ4.js";function z(r,o){if(r&1&&(n(0,"div",5),a(1),i()),r&2){let e=m();c(),b(e.mensaje)}}function G(r,o){r&1&&(n(0,"div"),a(1,"Cargando pacientes..."),i())}function U(r,o){r&1&&(n(0,"div",15),a(1," No se encontraron pacientes. "),i())}function R(r,o){if(r&1){let e=h();n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),i(),n(9,"td")(10,"button",20),p("click",function(){let t=d(e).$implicit,l=m(3);return _(l.editarPaciente(t))}),a(11,"Editar"),i(),n(12,"button",21),p("click",function(){let t=d(e).$implicit,l=m(3);return _(l.eliminarPaciente(t))}),a(13,"Eliminar"),i()()()}if(r&2){let e=o.$implicit;c(2),b(e.username),c(2),M("",e.first_name," ",e.last_name),c(2),b(e.email),c(2),b(e.telefono)}}function H(r,o){if(r&1&&(n(0,"div",16)(1,"table",17)(2,"thead")(3,"tr")(4,"th"),a(5,"Usuario"),i(),n(6,"th"),a(7,"Nombre"),i(),n(8,"th"),a(9,"Correo"),i(),n(10,"th"),a(11,"Tel\xE9fono"),i(),n(12,"th",18),a(13,"Acciones"),i()()(),n(14,"tbody"),P(15,R,14,5,"tr",19),i()()()),r&2){let e=m(2);c(15),u("ngForOf",e.pacientes)}}function J(r,o){if(r&1){let e=h();w(0),n(1,"div",6)(2,"div",7)(3,"div",8)(4,"input",9),x("ngModelChange",function(t){d(e);let l=m();return f(l.busqueda,t)||(l.busqueda=t),_(t)}),p("keyup.enter",function(){d(e);let t=m();return _(t.buscar())}),i(),n(5,"button",10),p("click",function(){d(e);let t=m();return _(t.buscar())}),a(6,"Buscar"),i()()(),n(7,"div",11)(8,"button",12),p("click",function(){d(e);let t=m();return _(t.nuevoPaciente())}),a(9,"A\xF1adir Paciente"),i()()(),P(10,G,2,0,"div",4)(11,U,2,0,"div",13)(12,H,16,1,"div",14),C()}if(r&2){let e=m();c(4),g("ngModel",e.busqueda),c(6),u("ngIf",e.cargando),c(),u("ngIf",!e.cargando&&e.pacientes.length===0),c(),u("ngIf",!e.cargando&&e.pacientes.length>0)}}function K(r,o){r&1&&(n(0,"h4"),a(1,"A\xF1adir Paciente"),i())}function Q(r,o){r&1&&(n(0,"h4"),a(1,"Editar Paciente"),i())}function X(r,o){if(r&1){let e=h();n(0,"div",23)(1,"label",24),a(2,"Contrase\xF1a"),i(),n(3,"input",35),x("ngModelChange",function(t){d(e);let l=m(2);return f(l.formPaciente.password,t)||(l.formPaciente.password=t),_(t)}),i()()}if(r&2){let e=m(2);c(3),g("ngModel",e.formPaciente.password)}}function Y(r,o){if(r&1){let e=h();w(0),P(1,K,2,0,"h4",4)(2,Q,2,0,"h4",4),n(3,"form",22,0),p("ngSubmit",function(){d(e);let t=m();return _(t.guardarPaciente())}),n(5,"div",23)(6,"label",24),a(7,"Usuario"),i(),n(8,"input",25),x("ngModelChange",function(t){d(e);let l=m();return f(l.formPaciente.username,t)||(l.formPaciente.username=t),_(t)}),i()(),n(9,"div",23)(10,"label",24),a(11,"Correo"),i(),n(12,"input",26),x("ngModelChange",function(t){d(e);let l=m();return f(l.formPaciente.email,t)||(l.formPaciente.email=t),_(t)}),i()(),n(13,"div",27)(14,"div",28)(15,"label",24),a(16,"Nombres"),i(),n(17,"input",29),x("ngModelChange",function(t){d(e);let l=m();return f(l.formPaciente.first_name,t)||(l.formPaciente.first_name=t),_(t)}),i()(),n(18,"div",28)(19,"label",24),a(20,"Apellidos"),i(),n(21,"input",30),x("ngModelChange",function(t){d(e);let l=m();return f(l.formPaciente.last_name,t)||(l.formPaciente.last_name=t),_(t)}),i()()(),n(22,"div",23)(23,"label",24),a(24,"Tel\xE9fono"),i(),n(25,"input",31),x("ngModelChange",function(t){d(e);let l=m();return f(l.formPaciente.telefono,t)||(l.formPaciente.telefono=t),_(t)}),i()(),P(26,X,4,1,"div",32),n(27,"button",33),a(28),i(),n(29,"button",34),p("click",function(){d(e);let t=m();return _(t.cancelarFormulario())}),a(30," Cancelar "),i()(),C()}if(r&2){let e=m();c(),u("ngIf",e.modo==="crear"),c(),u("ngIf",e.modo==="editar"),c(6),g("ngModel",e.formPaciente.username),c(4),g("ngModel",e.formPaciente.email),c(5),g("ngModel",e.formPaciente.first_name),c(4),g("ngModel",e.formPaciente.last_name),c(4),g("ngModel",e.formPaciente.telefono),c(),u("ngIf",e.modo==="crear"),c(2),A(" ",e.modo==="crear"?"Crear Paciente":"Guardar Cambios"," ")}}var O=class r{constructor(o){this.svc=o}pacientes=[];cargando=!0;mensaje="";busqueda="";mostrandoFormulario=!1;modo="crear";formPaciente=this.formPorDefecto();ngOnInit(){this.cargarPacientes()}formPorDefecto(){return{id:null,username:"",email:"",first_name:"",last_name:"",telefono:"",password:""}}cargarPacientes(){this.cargando=!0,this.svc.listar(this.busqueda).subscribe({next:o=>{this.pacientes=o,this.cargando=!1},error:o=>{console.error("Error cargando pacientes:",o),this.mensaje="Error cargando pacientes",this.cargando=!1}})}buscar(){this.cargarPacientes()}nuevoPaciente(){this.modo="crear",this.formPaciente=this.formPorDefecto(),this.mostrandoFormulario=!0}editarPaciente(o){this.modo="editar",this.formPaciente=y(v({},o),{password:""}),this.mostrandoFormulario=!0}cancelarFormulario(){this.mostrandoFormulario=!1,this.formPaciente=this.formPorDefecto(),this.modo="crear"}guardarPaciente(){this.modo==="crear"?this.svc.crear(this.formPaciente).subscribe({next:()=>{this.mensaje="Paciente creado.",this.cancelarFormulario(),this.cargarPacientes()},error:o=>{console.error("Error creando paciente:",o),this.mensaje="Error creando paciente."}}):this.svc.actualizar(this.formPaciente.id,this.formPaciente).subscribe({next:()=>{this.mensaje="Paciente actualizado.",this.cancelarFormulario(),this.cargarPacientes()},error:o=>{console.error("Error actualizando paciente:",o),this.mensaje="Error actualizando paciente."}})}eliminarPaciente(o){confirm(`\xBFEliminar al paciente "${o.username}"?`)&&this.svc.eliminar(o.id).subscribe({next:()=>{this.mensaje="Paciente eliminado.",this.cargarPacientes()},error:e=>{console.error("Error eliminando paciente:",e),this.mensaje="Error eliminando paciente."}})}static \u0275fac=function(e){return new(e||r)(S(L))};static \u0275cmp=E({type:r,selectors:[["app-panel-admin"]],decls:6,vars:3,consts:[["pacForm","ngForm"],[1,"container","mt-4"],[1,"text-danger","mb-4"],["class","alert alert-info",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-info"],[1,"row","mb-3","g-2","align-items-center"],[1,"col-sm"],[1,"input-group"],["type","text","placeholder","Buscar paciente...",1,"form-control",3,"ngModelChange","keyup.enter","ngModel"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"col-auto"],["type","button",1,"btn","btn-success",3,"click"],["class","alert alert-warning",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"alert","alert-warning"],[1,"table-responsive"],[1,"table","table-striped","align-middle"],[2,"width","130px"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-primary","me-1",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"mt-3",3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["name","username","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","email","type","email",1,"form-control",3,"ngModelChange","ngModel"],[1,"row"],[1,"col-md-6","mb-3"],["name","first_name",1,"form-control",3,"ngModelChange","ngModel"],["name","last_name",1,"form-control",3,"ngModelChange","ngModel"],["name","telefono",1,"form-control",3,"ngModelChange","ngModel"],["class","mb-3",4,"ngIf"],["type","submit",1,"btn","btn-success"],["type","button",1,"btn","btn-secondary","ms-2",3,"click"],["name","password","type","password",1,"form-control",3,"ngModelChange","ngModel"]],template:function(e,s){e&1&&(n(0,"div",1)(1,"h2",2),a(2,"Panel de Administrador"),i(),P(3,z,2,1,"div",3)(4,J,13,4,"ng-container",4)(5,Y,31,9,"ng-container",4),i()),e&2&&(c(3),u("ngIf",s.mensaje),c(),u("ngIf",!s.mostrandoFormulario),c(),u("ngIf",s.mostrandoFormulario))},dependencies:[I,V,T,q,B,F,W,k,D,j,N],encapsulation:2})};export{O as PanelAdmin};

import{b as N,c as B,d as U,e as H,f as D,g as q,k as L,l as z}from"./chunk-U7CS2GOG.js";import{Bb as F,Cb as k,Da as x,Db as W,Lb as j,N as E,Oa as u,Pa as i,Qa as r,R as A,Sa as C,Ta as v,Ua as P,Va as p,Wa as s,X as d,Y as _,a as y,ab as o,b as S,bb as b,cb as I,db as T,eb as g,fb as f,gb as h,pa as c,ta as M,za as V}from"./chunk-M3ESIO4O.js";var w=class a{constructor(n){this.http=n}baseUrl="/api/admin/pacientes/";authHeaders(){return{Authorization:`Bearer ${localStorage.getItem("token")||""}`}}listar(n=""){let e=n?`${this.baseUrl}?q=${encodeURIComponent(n)}`:this.baseUrl;return this.http.get(e,{headers:this.authHeaders()})}crear(n){return this.http.post(this.baseUrl,n,{headers:this.authHeaders()})}obtener(n){return this.http.get(`${this.baseUrl}${n}/`,{headers:this.authHeaders()})}actualizar(n,e){return this.http.patch(`${this.baseUrl}${n}/`,e,{headers:this.authHeaders()})}eliminar(n){return this.http.delete(`${this.baseUrl}${n}/`,{headers:this.authHeaders()})}static \u0275fac=function(e){return new(e||a)(A(j))};static \u0275prov=E({token:a,factory:a.\u0275fac,providedIn:"root"})};function J(a,n){if(a&1&&(i(0,"div",5),o(1),r()),a&2){let e=s();c(),b(e.mensaje)}}function K(a,n){a&1&&(i(0,"div"),o(1,"Cargando pacientes..."),r())}function Q(a,n){a&1&&(i(0,"div",15),o(1," No se encontraron pacientes. "),r())}function X(a,n){if(a&1){let e=P();i(0,"tr")(1,"td"),o(2),r(),i(3,"td"),o(4),r(),i(5,"td"),o(6),r(),i(7,"td"),o(8),r(),i(9,"td")(10,"button",20),p("click",function(){let t=d(e).$implicit,l=s(3);return _(l.editarPaciente(t))}),o(11,"Editar"),r(),i(12,"button",21),p("click",function(){let t=d(e).$implicit,l=s(3);return _(l.eliminarPaciente(t))}),o(13,"Eliminar"),r()()()}if(a&2){let e=n.$implicit;c(2),b(e.username),c(2),T("",e.first_name," ",e.last_name),c(2),b(e.email),c(2),b(e.telefono)}}function Y(a,n){if(a&1&&(i(0,"div",16)(1,"table",17)(2,"thead")(3,"tr")(4,"th"),o(5,"Usuario"),r(),i(6,"th"),o(7,"Nombre"),r(),i(8,"th"),o(9,"Correo"),r(),i(10,"th"),o(11,"Tel\xE9fono"),r(),i(12,"th",18),o(13,"Acciones"),r()()(),i(14,"tbody"),x(15,X,14,5,"tr",19),r()()()),a&2){let e=s(2);c(15),u("ngForOf",e.pacientes)}}function Z(a,n){if(a&1){let e=P();C(0),i(1,"div",6)(2,"div",7)(3,"div",8)(4,"input",9),h("ngModelChange",function(t){d(e);let l=s();return f(l.busqueda,t)||(l.busqueda=t),_(t)}),p("keyup.enter",function(){d(e);let t=s();return _(t.buscar())}),r(),i(5,"button",10),p("click",function(){d(e);let t=s();return _(t.buscar())}),o(6,"Buscar"),r()()(),i(7,"div",11)(8,"button",12),p("click",function(){d(e);let t=s();return _(t.nuevoPaciente())}),o(9,"A\xF1adir Paciente"),r()()(),x(10,K,2,0,"div",4)(11,Q,2,0,"div",13)(12,Y,16,1,"div",14),v()}if(a&2){let e=s();c(4),g("ngModel",e.busqueda),c(6),u("ngIf",e.cargando),c(),u("ngIf",!e.cargando&&e.pacientes.length===0),c(),u("ngIf",!e.cargando&&e.pacientes.length>0)}}function $(a,n){a&1&&(i(0,"h4"),o(1,"A\xF1adir Paciente"),r())}function ee(a,n){a&1&&(i(0,"h4"),o(1,"Editar Paciente"),r())}function te(a,n){if(a&1){let e=P();i(0,"div",23)(1,"label",24),o(2,"Contrase\xF1a"),r(),i(3,"input",35),h("ngModelChange",function(t){d(e);let l=s(2);return f(l.formPaciente.password,t)||(l.formPaciente.password=t),_(t)}),r()()}if(a&2){let e=s(2);c(3),g("ngModel",e.formPaciente.password)}}function ne(a,n){if(a&1){let e=P();C(0),x(1,$,2,0,"h4",4)(2,ee,2,0,"h4",4),i(3,"form",22,0),p("ngSubmit",function(){d(e);let t=s();return _(t.guardarPaciente())}),i(5,"div",23)(6,"label",24),o(7,"Usuario"),r(),i(8,"input",25),h("ngModelChange",function(t){d(e);let l=s();return f(l.formPaciente.username,t)||(l.formPaciente.username=t),_(t)}),r()(),i(9,"div",23)(10,"label",24),o(11,"Correo"),r(),i(12,"input",26),h("ngModelChange",function(t){d(e);let l=s();return f(l.formPaciente.email,t)||(l.formPaciente.email=t),_(t)}),r()(),i(13,"div",27)(14,"div",28)(15,"label",24),o(16,"Nombres"),r(),i(17,"input",29),h("ngModelChange",function(t){d(e);let l=s();return f(l.formPaciente.first_name,t)||(l.formPaciente.first_name=t),_(t)}),r()(),i(18,"div",28)(19,"label",24),o(20,"Apellidos"),r(),i(21,"input",30),h("ngModelChange",function(t){d(e);let l=s();return f(l.formPaciente.last_name,t)||(l.formPaciente.last_name=t),_(t)}),r()()(),i(22,"div",23)(23,"label",24),o(24,"Tel\xE9fono"),r(),i(25,"input",31),h("ngModelChange",function(t){d(e);let l=s();return f(l.formPaciente.telefono,t)||(l.formPaciente.telefono=t),_(t)}),r()(),x(26,te,4,1,"div",32),i(27,"button",33),o(28),r(),i(29,"button",34),p("click",function(){d(e);let t=s();return _(t.cancelarFormulario())}),o(30," Cancelar "),r()(),v()}if(a&2){let e=s();c(),u("ngIf",e.modo==="crear"),c(),u("ngIf",e.modo==="editar"),c(6),g("ngModel",e.formPaciente.username),c(4),g("ngModel",e.formPaciente.email),c(5),g("ngModel",e.formPaciente.first_name),c(4),g("ngModel",e.formPaciente.last_name),c(4),g("ngModel",e.formPaciente.telefono),c(),u("ngIf",e.modo==="crear"),c(2),I(" ",e.modo==="crear"?"Crear Paciente":"Guardar Cambios"," ")}}var O=class a{constructor(n){this.svc=n}pacientes=[];cargando=!0;mensaje="";busqueda="";mostrandoFormulario=!1;modo="crear";formPaciente=this.formPorDefecto();ngOnInit(){this.cargarPacientes()}formPorDefecto(){return{id:null,username:"",email:"",first_name:"",last_name:"",telefono:"",password:""}}cargarPacientes(){this.cargando=!0,this.svc.listar(this.busqueda).subscribe({next:n=>{this.pacientes=n,this.cargando=!1},error:n=>{console.error("Error cargando pacientes:",n),this.mensaje="Error cargando pacientes",this.cargando=!1}})}buscar(){this.cargarPacientes()}nuevoPaciente(){this.modo="crear",this.formPaciente=this.formPorDefecto(),this.mostrandoFormulario=!0}editarPaciente(n){this.modo="editar",this.formPaciente=S(y({},n),{password:""}),this.mostrandoFormulario=!0}cancelarFormulario(){this.mostrandoFormulario=!1,this.formPaciente=this.formPorDefecto(),this.modo="crear"}guardarPaciente(){this.modo==="crear"?this.svc.crear(this.formPaciente).subscribe({next:()=>{this.mensaje="Paciente creado.",this.cancelarFormulario(),this.cargarPacientes()},error:n=>{console.error("Error creando paciente:",n),this.mensaje="Error creando paciente."}}):this.svc.actualizar(this.formPaciente.id,this.formPaciente).subscribe({next:()=>{this.mensaje="Paciente actualizado.",this.cancelarFormulario(),this.cargarPacientes()},error:n=>{console.error("Error actualizando paciente:",n),this.mensaje="Error actualizando paciente."}})}eliminarPaciente(n){confirm(`\xBFEliminar al paciente "${n.username}"?`)&&this.svc.eliminar(n.id).subscribe({next:()=>{this.mensaje="Paciente eliminado.",this.cargarPacientes()},error:e=>{console.error("Error eliminando paciente:",e),this.mensaje="Error eliminando paciente."}})}static \u0275fac=function(e){return new(e||a)(M(w))};static \u0275cmp=V({type:a,selectors:[["app-panel-admin"]],decls:6,vars:3,consts:[["pacForm","ngForm"],[1,"container","mt-4"],[1,"text-danger","mb-4"],["class","alert alert-info",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-info"],[1,"row","mb-3","g-2","align-items-center"],[1,"col-sm"],[1,"input-group"],["type","text","placeholder","Buscar paciente...",1,"form-control",3,"ngModelChange","keyup.enter","ngModel"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"col-auto"],["type","button",1,"btn","btn-success",3,"click"],["class","alert alert-warning",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"alert","alert-warning"],[1,"table-responsive"],[1,"table","table-striped","align-middle"],[2,"width","130px"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-primary","me-1",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"mt-3",3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["name","username","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","email","type","email",1,"form-control",3,"ngModelChange","ngModel"],[1,"row"],[1,"col-md-6","mb-3"],["name","first_name",1,"form-control",3,"ngModelChange","ngModel"],["name","last_name",1,"form-control",3,"ngModelChange","ngModel"],["name","telefono",1,"form-control",3,"ngModelChange","ngModel"],["class","mb-3",4,"ngIf"],["type","submit",1,"btn","btn-success"],["type","button",1,"btn","btn-secondary","ms-2",3,"click"],["name","password","type","password",1,"form-control",3,"ngModelChange","ngModel"]],template:function(e,m){e&1&&(i(0,"div",1)(1,"h2",2),o(2,"Panel de Administrador"),r(),x(3,J,2,1,"div",3)(4,Z,13,4,"ng-container",4)(5,ne,31,9,"ng-container",4),r()),e&2&&(c(3),u("ngIf",m.mensaje),c(),u("ngIf",!m.mostrandoFormulario),c(),u("ngIf",m.mostrandoFormulario))},dependencies:[W,F,k,z,q,N,B,U,L,D,H],encapsulation:2})};export{O as PanelAdmin};

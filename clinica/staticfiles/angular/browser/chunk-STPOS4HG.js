import{b as W}from"./chunk-M3S67UJ3.js";import{b as M,c as N,d as j,e as k,f as O,g as D,k as $,l as z}from"./chunk-U7CS2GOG.js";import{Bb as F,Cb as T,Da as _,Db as V,Oa as l,Pa as n,Qa as a,Sa as u,Ta as f,Ua as x,Va as g,Wa as o,X as m,Y as p,_a as I,a as v,ab as r,bb as h,cb as b,eb as y,fb as A,gb as w,ib as P,pa as d,ta as S,za as C}from"./chunk-M3ESIO4O.js";function G(i,t){if(i&1&&(n(0,"div",6),r(1),a()),i&2){let e=o();d(),h(e.mensaje)}}function L(i,t){i&1&&(n(0,"div"),r(1,"Cargando especialidades..."),a())}function R(i,t){i&1&&(n(0,"div",11),r(1," No se encontraron especialidades. "),a())}function B(i,t){if(i&1&&(n(0,"li"),r(1),n(2,"span",20),r(3),a()()),i&2){let e=t.$implicit;d(),b(" ",e.nombres," "),d(2),b("(",e.correo,")")}}function H(i,t){if(i&1&&(u(0),n(1,"ul",19),_(2,B,4,2,"li",15),a(),f()),i&2){let e=o().$implicit;d(2),l("ngForOf",e.medicos)}}function J(i,t){i&1&&(n(0,"span",21),r(1,"Sin m\xE9dicos registrados."),a())}function K(i,t){if(i&1){let e=x();n(0,"tr")(1,"td"),r(2),a(),n(3,"td"),_(4,H,3,1,"ng-container",16)(5,J,2,0,"ng-template",null,0,P),a(),n(7,"td")(8,"button",17),g("click",function(){let s=m(e).$implicit,E=o(3);return p(E.editarEspecialidad(s))}),r(9,"Editar"),a(),n(10,"button",18),g("click",function(){let s=m(e).$implicit,E=o(3);return p(E.eliminarEspecialidad(s))}),r(11,"Eliminar"),a()()()}if(i&2){let e=t.$implicit,c=I(6);d(2),h(e.nombre),d(2),l("ngIf",e.medicos==null?null:e.medicos.length)("ngIfElse",c)}}function Q(i,t){if(i&1&&(n(0,"div",12)(1,"table",13)(2,"thead")(3,"tr")(4,"th"),r(5,"Nombre"),a(),n(6,"th"),r(7,"M\xE9dicos"),a(),n(8,"th",14),r(9,"Acciones"),a()()(),n(10,"tbody"),_(11,K,12,3,"tr",15),a()()()),i&2){let e=o(2);d(11),l("ngForOf",e.especialidades)}}function U(i,t){if(i&1){let e=x();u(0),n(1,"div",7)(2,"h4"),r(3,"Lista de Especialidades"),a(),n(4,"button",8),g("click",function(){m(e);let s=o();return p(s.nuevaEspecialidad())}),r(5,"A\xF1adir Especialidad"),a()(),_(6,L,2,0,"div",5)(7,R,2,0,"div",9)(8,Q,12,1,"div",10),f()}if(i&2){let e=o();d(6),l("ngIf",e.cargando),d(),l("ngIf",!e.cargando&&e.especialidades.length===0),d(),l("ngIf",!e.cargando&&e.especialidades.length>0)}}function X(i,t){i&1&&(n(0,"h4"),r(1,"A\xF1adir Especialidad"),a())}function Y(i,t){i&1&&(n(0,"h4"),r(1,"Editar Especialidad"),a())}function Z(i,t){if(i&1){let e=x();u(0),_(1,X,2,0,"h4",5)(2,Y,2,0,"h4",5),n(3,"form",22,1),g("ngSubmit",function(){m(e);let s=o();return p(s.guardarEspecialidad())}),n(5,"div",23)(6,"label",24),r(7,"Nombre"),a(),n(8,"input",25),w("ngModelChange",function(s){m(e);let E=o();return A(E.formEspecialidad.nombre,s)||(E.formEspecialidad.nombre=s),p(s)}),a()(),n(9,"button",26),r(10),a(),n(11,"button",27),g("click",function(){m(e);let s=o();return p(s.cancelarFormulario())}),r(12,"Cancelar"),a()(),f()}if(i&2){let e=o();d(),l("ngIf",e.modo==="crear"),d(),l("ngIf",e.modo==="editar"),d(6),y("ngModel",e.formEspecialidad.nombre),d(2),b(" ",e.modo==="crear"?"Crear Especialidad":"Guardar Cambios"," ")}}var q=class i{constructor(t){this.espSvc=t}especialidades=[];cargando=!0;mensaje="";mostrandoFormulario=!1;modo="crear";formEspecialidad={id:0,nombre:""};ngOnInit(){this.cargarEspecialidades()}cargarEspecialidades(){this.cargando=!0,this.espSvc.getEspecialidadesConMedicos().subscribe({next:t=>{this.especialidades=t,this.cargando=!1},error:t=>{console.error("Error cargando especialidades:",t),this.mensaje="Error cargando especialidades",this.cargando=!1}})}nuevaEspecialidad(){this.modo="crear",this.formEspecialidad={id:0,nombre:""},this.mostrandoFormulario=!0}editarEspecialidad(t){this.modo="editar",this.formEspecialidad=v({},t),this.mostrandoFormulario=!0}cancelarFormulario(){this.mostrandoFormulario=!1,this.formEspecialidad={id:0,nombre:""},this.modo="crear"}guardarEspecialidad(){this.modo==="crear"?this.espSvc.crearEspecialidad(this.formEspecialidad.nombre).subscribe({next:()=>{this.mensaje="Especialidad creada.",this.cancelarFormulario(),this.cargarEspecialidades()},error:t=>{console.error("Error creando especialidad:",t),this.mensaje="Error creando especialidad."}}):this.espSvc.editarEspecialidad(this.formEspecialidad.id,this.formEspecialidad.nombre).subscribe({next:()=>{this.mensaje="Especialidad actualizada.",this.cancelarFormulario(),this.cargarEspecialidades()},error:t=>{console.error("Error actualizando especialidad:",t),this.mensaje="Error actualizando especialidad."}})}eliminarEspecialidad(t){confirm(`\xBFEliminar la especialidad "${t.nombre}"?`)&&this.espSvc.eliminarEspecialidad(t.id).subscribe({next:()=>{this.mensaje="Especialidad eliminada.",this.cargarEspecialidades()},error:e=>{console.error("Error eliminando especialidad:",e),this.mensaje="Error eliminando especialidad."}})}static \u0275fac=function(e){return new(e||i)(S(W))};static \u0275cmp=C({type:i,selectors:[["app-panel-admin-especialidades"]],decls:6,vars:3,consts:[["sinMedicos",""],["espForm","ngForm"],[1,"container","mt-4"],[1,"text-danger","mb-4"],["class","alert alert-info",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-info"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"btn","btn-success",3,"click"],["class","alert alert-warning",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"alert","alert-warning"],[1,"table-responsive"],[1,"table","table-striped","align-middle"],[2,"width","150px"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],[1,"btn","btn-sm","btn-primary","me-1",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"small","text-muted","mb-0","ps-3"],[1,"text-body-secondary"],[1,"text-muted","fst-italic"],[1,"mt-3",3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["name","nombre","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-success"],["type","button",1,"btn","btn-secondary","ms-2",3,"click"]],template:function(e,c){e&1&&(n(0,"div",2)(1,"h2",3),r(2,"Administrar Especialidades"),a(),_(3,G,2,1,"div",4)(4,U,9,3,"ng-container",5)(5,Z,13,4,"ng-container",5),a()),e&2&&(d(3),l("ngIf",c.mensaje),d(),l("ngIf",!c.mostrandoFormulario),d(),l("ngIf",c.mostrandoFormulario))},dependencies:[V,F,T,z,D,M,N,j,$,O,k],encapsulation:2})};export{q as PanelAdminEspecialidades};

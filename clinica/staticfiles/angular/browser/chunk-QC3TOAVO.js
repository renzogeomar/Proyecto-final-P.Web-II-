import{$a as u,Aa as h,Bb as W,Eb as F,Fb as H,Gb as D,Hb as j,Ib as O,Jb as B,Kb as L,La as m,Ma as i,Na as t,Oa as C,Pa as b,Pb as k,Qa as S,Ra as d,V as f,Va as y,W as g,Wa as M,Xa as n,Ya as c,Za as w,a as v,ab as _,bb as x,cb as I,na as l,ra as P,tb as T,ub as V,vb as N,xa as E}from"./chunk-AOE6QCIW.js";function G(o,a){o&1&&(i(0,"div",19),n(1,"No tienes citas registradas."),t())}function z(o,a){if(o&1&&(i(0,"tr")(1,"td"),n(2),t(),i(3,"td"),n(4),t(),i(5,"td"),n(6),t(),i(7,"td"),n(8),t(),i(9,"td"),n(10),t()()),o&2){let e=a.$implicit;l(2),c(e.fecha),l(2),c(e.hora),l(2),c(e.medico),l(2),c(e.especialidad),l(2),c(e.estado)}}function R(o,a){if(o&1&&(i(0,"div",20)(1,"table",21)(2,"thead")(3,"tr")(4,"th"),n(5,"Fecha"),t(),i(6,"th"),n(7,"Hora"),t(),i(8,"th"),n(9,"M\xE9dico"),t(),i(10,"th"),n(11,"Especialidad"),t(),i(12,"th"),n(13,"Estado"),t()()(),i(14,"tbody"),h(15,z,11,5,"tr",22),t()()()),o&2){let e=d(2);l(15),m("ngForOf",e.citas)}}function U(o,a){if(o&1){let e=b();i(0,"div",3)(1,"h2",4),n(2,"Mi Perfil"),t(),i(3,"form",5,1),S("ngSubmit",function(){f(e);let r=d();return g(r.guardarPerfil())}),i(5,"div",6)(6,"label",7),n(7,"Usuario"),t(),C(8,"input",8),t(),i(9,"div",6)(10,"label",7),n(11,"Correo"),t(),i(12,"input",9),x("ngModelChange",function(r){f(e);let s=d();return _(s.perfil.email,r)||(s.perfil.email=r),g(r)}),t()(),i(13,"div",6)(14,"label",7),n(15,"Tel\xE9fono"),t(),i(16,"input",10),x("ngModelChange",function(r){f(e);let s=d();return _(s.perfil.telefono,r)||(s.perfil.telefono=r),g(r)}),t()(),i(17,"div",11)(18,"div",12)(19,"label",7),n(20,"Nombres"),t(),i(21,"input",13),x("ngModelChange",function(r){f(e);let s=d();return _(s.perfil.first_name,r)||(s.perfil.first_name=r),g(r)}),t()(),i(22,"div",12)(23,"label",7),n(24,"Apellidos"),t(),i(25,"input",14),x("ngModelChange",function(r){f(e);let s=d();return _(s.perfil.last_name,r)||(s.perfil.last_name=r),g(r)}),t()()(),i(26,"button",15),n(27),t(),i(28,"span",16),n(29),t()(),i(30,"h3",6),n(31,"Historial de Citas"),t(),h(32,G,2,0,"div",17)(33,R,16,1,"div",18),t()}if(o&2){let e=d();l(8),m("value",e.perfil.username),l(4),u("ngModel",e.perfil.email),l(4),u("ngModel",e.perfil.telefono),l(5),u("ngModel",e.perfil.first_name),l(4),u("ngModel",e.perfil.last_name),l(),m("disabled",e.guardando),l(),w(" ",e.guardando?"Guardando...":"Guardar cambios"," "),l(),M("text-success",e.mensaje&&!e.guardando),l(),c(e.mensaje),l(3),m("ngIf",e.citas.length===0),l(),m("ngIf",e.citas.length>0)}}function q(o,a){o&1&&(i(0,"div",3)(1,"p"),n(2,"Cargando perfil..."),t()())}var A=class o{constructor(a){this.http=a}perfil=null;citas=[];mensaje="";guardando=!1;ngOnInit(){this.cargarPerfil(),this.cargarCitas()}authHeaders(){return{Authorization:`Bearer ${localStorage.getItem("token")||""}`}}cargarPerfil(){this.http.get("/api/paciente/perfil/",{headers:this.authHeaders()}).subscribe({next:a=>this.perfil=v({},a),error:a=>console.error("Error cargando perfil:",a)})}cargarCitas(){this.http.get("/api/paciente/citas/",{headers:this.authHeaders()}).subscribe({next:a=>this.citas=a,error:a=>console.error("Error cargando citas:",a)})}guardarPerfil(){this.perfil&&(this.guardando=!0,this.http.patch("/api/paciente/perfil/",this.perfil,{headers:this.authHeaders()}).subscribe({next:a=>{this.mensaje=a.message||"Perfil actualizado.",this.guardando=!1},error:a=>{console.error("Error guardando perfil:",a),this.mensaje="Error al guardar.",this.guardando=!1}}))}static \u0275fac=function(e){return new(e||o)(P(W))};static \u0275cmp=E({type:o,selectors:[["app-perfil-paciente"]],decls:3,vars:2,consts:[["cargandoTpl",""],["perfilForm","ngForm"],["class","container mt-4",4,"ngIf","ngIfElse"],[1,"container","mt-4"],[1,"text-primary","mb-4"],[1,"mb-5",3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["disabled","",1,"form-control",3,"value"],["name","email",1,"form-control",3,"ngModelChange","ngModel"],["name","telefono",1,"form-control",3,"ngModelChange","ngModel"],[1,"row"],[1,"col-md-6","mb-3"],["name","first_name",1,"form-control",3,"ngModelChange","ngModel"],["name","last_name",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"ms-3"],["class","alert alert-info",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"alert","alert-info"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"]],template:function(e,p){if(e&1&&h(0,U,34,12,"div",2)(1,q,3,0,"ng-template",null,0,I),e&2){let r=y(2);m("ngIf",p.perfil)("ngIfElse",r)}},dependencies:[N,T,V,k,L,H,D,j,B,O,F],encapsulation:2})};export{A as PerfilPaciente};

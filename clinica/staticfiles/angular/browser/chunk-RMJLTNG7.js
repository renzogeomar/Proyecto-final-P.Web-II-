import{a as X,b as Y}from"./chunk-NSW2O43E.js";import{a as N,b as z,c as $,d as q,e as B,f as U,g as L,h as G,i as R,j as J,k as K,l as Q}from"./chunk-U7CS2GOG.js";import{Ab as j,Bb as F,Cb as O,Da as h,Db as W,Jb as y,Kb as D,Lb as w,N as E,Oa as m,Pa as t,Qa as r,R as v,Ra as T,Sa as S,Ta as C,Ua as M,Va as u,Wa as l,X as _,Y as p,a as I,ab as a,bb as g,cb as H,eb as f,fb as b,gb as x,pa as c,ta as A,za as k}from"./chunk-M3ESIO4O.js";var P=class n{constructor(i){this.http=i}baseUrl="/api/admin/medicos/";authHeaders(){let i=localStorage.getItem("token")||"";return new y({Authorization:`Bearer ${i}`})}listar(i=""){let e=new D;return i&&(e=e.set("q",i)),this.http.get(this.baseUrl,{headers:this.authHeaders(),params:e})}crear(i){return this.http.post(this.baseUrl,i,{headers:this.authHeaders()})}actualizar(i,e){return this.http.put(`${this.baseUrl}${i}/`,e,{headers:this.authHeaders()})}eliminar(i){return this.http.delete(`${this.baseUrl}${i}/`,{headers:this.authHeaders()})}static \u0275fac=function(e){return new(e||n)(v(w))};static \u0275prov=E({token:n,factory:n.\u0275fac,providedIn:"root"})};var V=class n{constructor(i,e){this.http=i;this.auth=e}baseUrl="/api/admin";authHeaders(){let i=this.auth.obtenerToken()||"";return new y({Authorization:`Bearer ${i}`})}listar(i){return this.http.get(`${this.baseUrl}/medicos/${i}/horarios/`,{headers:this.authHeaders()})}crear(i,e){return this.http.post(`${this.baseUrl}/medicos/${i}/horarios/`,e,{headers:this.authHeaders()})}actualizar(i,e){return this.http.put(`${this.baseUrl}/horarios/${i}/`,e,{headers:this.authHeaders()})}eliminar(i){return this.http.delete(`${this.baseUrl}/horarios/${i}/`,{headers:this.authHeaders()})}static \u0275fac=function(e){return new(e||n)(v(w),v(X))};static \u0275prov=E({token:n,factory:n.\u0275fac,providedIn:"root"})};function ne(n,i){if(n&1&&(t(0,"div",6),a(1),r()),n&2){let e=l();c(),g(e.mensaje)}}function oe(n,i){n&1&&(t(0,"div"),a(1,"Cargando m\xE9dicos..."),r())}function ae(n,i){n&1&&(t(0,"div",16),a(1," No se encontraron m\xE9dicos. "),r())}function ce(n,i){if(n&1){let e=M();t(0,"tr")(1,"td"),a(2),r(),t(3,"td"),a(4),r(),t(5,"td"),a(6),r(),t(7,"td")(8,"button",21),u("click",function(){let o=_(e).$implicit,s=l(3);return p(s.editarMedico(o))}),a(9,"Editar"),r(),t(10,"button",22),u("click",function(){let o=_(e).$implicit,s=l(3);return p(s.eliminarMedico(o))}),a(11,"Eliminar"),r(),t(12,"button",23),u("click",function(){let o=_(e).$implicit,s=l(3);return p(s.verHorarios(o))}),a(13,"Horarios"),r()()()}if(n&2){let e=i.$implicit,d=l(3);c(2),g(e.nombres),c(2),g(e.correo),c(2),g(d.nombreDeEspecialidad(e.especialidad))}}function se(n,i){if(n&1&&(t(0,"div",17)(1,"table",18)(2,"thead")(3,"tr")(4,"th"),a(5,"Nombre"),r(),t(6,"th"),a(7,"Correo"),r(),t(8,"th"),a(9,"Especialidad"),r(),t(10,"th",19),a(11,"Acciones"),r()()(),t(12,"tbody"),h(13,ce,14,3,"tr",20),r()()()),n&2){let e=l(2);c(13),m("ngForOf",e.medicos)}}function de(n,i){if(n&1){let e=M();S(0),t(1,"div",7)(2,"div",8)(3,"div",9)(4,"input",10),x("ngModelChange",function(o){_(e);let s=l();return b(s.busqueda,o)||(s.busqueda=o),p(o)}),u("keyup.enter",function(){_(e);let o=l();return p(o.buscar())}),r(),t(5,"button",11),u("click",function(){_(e);let o=l();return p(o.buscar())}),a(6,"Buscar"),r()()(),t(7,"div",12)(8,"button",13),u("click",function(){_(e);let o=l();return p(o.nuevoMedico())}),a(9,"A\xF1adir M\xE9dico"),r()()(),h(10,oe,2,0,"div",5)(11,ae,2,0,"div",14)(12,se,14,1,"div",15),C()}if(n&2){let e=l();c(4),f("ngModel",e.busqueda),c(6),m("ngIf",e.cargando),c(),m("ngIf",!e.cargando&&e.medicos.length===0),c(),m("ngIf",!e.cargando&&e.medicos.length>0)}}function le(n,i){n&1&&(t(0,"h4"),a(1,"A\xF1adir M\xE9dico"),r())}function me(n,i){n&1&&(t(0,"h4"),a(1,"Editar M\xE9dico"),r())}function _e(n,i){if(n&1&&(t(0,"option",34),a(1),r()),n&2){let e=i.$implicit;m("ngValue",e.id),c(),g(e.nombre)}}function pe(n,i){if(n&1){let e=M();S(0),h(1,le,2,0,"h4",5)(2,me,2,0,"h4",5),t(3,"form",24,0),u("ngSubmit",function(){_(e);let o=l();return p(o.guardarMedico())}),t(5,"div",25)(6,"label",26),a(7,"Nombres"),r(),t(8,"input",27),x("ngModelChange",function(o){_(e);let s=l();return b(s.formMedico.nombres,o)||(s.formMedico.nombres=o),p(o)}),r()(),t(9,"div",25)(10,"label",26),a(11,"Correo"),r(),t(12,"input",28),x("ngModelChange",function(o){_(e);let s=l();return b(s.formMedico.correo,o)||(s.formMedico.correo=o),p(o)}),r()(),t(13,"div",25)(14,"label",26),a(15,"Especialidad"),r(),t(16,"select",29),x("ngModelChange",function(o){_(e);let s=l();return b(s.formMedico.especialidad,o)||(s.formMedico.especialidad=o),p(o)}),t(17,"option",30),a(18,"--Seleccione--"),r(),h(19,_e,2,2,"option",31),r()(),t(20,"button",32),a(21),r(),t(22,"button",33),u("click",function(){_(e);let o=l();return p(o.cancelarMedico())}),a(23,"Cancelar"),r()(),C()}if(n&2){let e=l();c(),m("ngIf",e.modo==="crear"),c(),m("ngIf",e.modo==="editar"),c(6),f("ngModel",e.formMedico.nombres),c(4),f("ngModel",e.formMedico.correo),c(4),f("ngModel",e.formMedico.especialidad),c(),m("ngValue",null),c(2),m("ngForOf",e.especialidades),c(2),H(" ",e.modo==="crear"?"Crear M\xE9dico":"Guardar Cambios"," ")}}function ue(n,i){n&1&&(t(0,"div"),a(1,"Cargando horarios..."),r())}function he(n,i){n&1&&(t(0,"div",16),a(1," No hay horarios registrados para este m\xE9dico. "),r())}function ge(n,i){if(n&1){let e=M();t(0,"tr")(1,"td"),a(2),r(),t(3,"td"),a(4),r(),t(5,"td")(6,"span",53),a(7),r()(),t(8,"td")(9,"button",21),u("click",function(){let o=_(e).$implicit,s=l(3);return p(s.editarHorario(o))}),a(10,"Editar"),r(),t(11,"button",54),u("click",function(){let o=_(e).$implicit,s=l(3);return p(s.eliminarHorario(o))}),a(12,"Eliminar"),r()()()}if(n&2){let e=i.$implicit;c(2),g(e.fecha),c(2),g(e.hora),c(2),m("ngClass",e.disponible?"bg-success":"bg-secondary"),c(),H(" ",e.disponible?"S\xED":"No"," ")}}function fe(n,i){if(n&1&&(t(0,"div",17)(1,"table",50)(2,"thead",51)(3,"tr")(4,"th"),a(5,"Fecha"),r(),t(6,"th"),a(7,"Hora"),r(),t(8,"th"),a(9,"Disponible"),r(),t(10,"th",52),a(11,"Acciones"),r()()(),t(12,"tbody"),h(13,ge,13,4,"tr",20),r()()()),n&2){let e=l(2);c(13),m("ngForOf",e.horarios)}}function be(n,i){n&1&&(t(0,"h5"),a(1,"A\xF1adir Horario"),r())}function xe(n,i){n&1&&(t(0,"h5"),a(1,"Editar Horario"),r())}function Me(n,i){if(n&1){let e=M();t(0,"button",33),u("click",function(){_(e);let o=l(2);return p(o.cancelarHorario())}),a(1," Cancelar "),r()}}function ve(n,i){if(n&1){let e=M();S(0),t(1,"div",35)(2,"h4"),a(3," Horarios de: "),t(4,"span",36),a(5),r(),t(6,"small",37),a(7),r()(),t(8,"button",38),u("click",function(){_(e);let o=l();return p(o.volverAListaMedicos())}),a(9," \u2190 Volver a m\xE9dicos "),r()(),h(10,ue,2,0,"div",5)(11,he,2,0,"div",14)(12,fe,14,1,"div",15),T(13,"hr",39),h(14,be,2,0,"h5",5)(15,xe,2,0,"h5",5),t(16,"form",40,1),u("ngSubmit",function(){_(e);let o=l();return p(o.guardarHorario())}),t(18,"div",41)(19,"label",26),a(20,"Fecha"),r(),t(21,"input",42),x("ngModelChange",function(o){_(e);let s=l();return b(s.formHorario.fecha,o)||(s.formHorario.fecha=o),p(o)}),r()(),t(22,"div",41)(23,"label",26),a(24,"Hora"),r(),t(25,"input",43),x("ngModelChange",function(o){_(e);let s=l();return b(s.formHorario.hora,o)||(s.formHorario.hora=o),p(o)}),r()(),t(26,"div",44)(27,"div",45)(28,"input",46),x("ngModelChange",function(o){_(e);let s=l();return b(s.formHorario.disponible,o)||(s.formHorario.disponible=o),p(o)}),r(),t(29,"label",47),a(30,"Disponible"),r()()(),t(31,"div",48)(32,"button",32),a(33),r(),h(34,Me,2,0,"button",49),r()(),C()}if(n&2){let e=l();c(5),g(e.medicoActual==null?null:e.medicoActual.nombres),c(2),H("(",e.nombreDeEspecialidad((e.medicoActual==null?null:e.medicoActual.especialidad)||0),")"),c(3),m("ngIf",e.cargandoHorarios),c(),m("ngIf",!e.cargandoHorarios&&e.horarios.length===0),c(),m("ngIf",!e.cargandoHorarios&&e.horarios.length>0),c(2),m("ngIf",e.modoHorario==="crear"),c(),m("ngIf",e.modoHorario==="editar"),c(6),f("ngModel",e.formHorario.fecha),c(4),f("ngModel",e.formHorario.hora),c(3),f("ngModel",e.formHorario.disponible),c(5),H(" ",e.modoHorario==="crear"?"Crear Horario":"Guardar Cambios"," "),c(),m("ngIf",e.modoHorario==="editar")}}var ee=class n{constructor(i,e,d){this.svc=i;this.espSvc=e;this.horSvc=d}medicos=[];especialidades=[];cargando=!0;mensaje="";busqueda="";vista="lista";modo="crear";formMedico=this.formMedicoPorDefecto();medicoActual=null;horarios=[];cargandoHorarios=!1;modoHorario="crear";formHorario=this.formHorarioPorDefecto();ngOnInit(){this.cargarEspecialidades(),this.cargarMedicos()}formMedicoPorDefecto(){return{id:null,nombres:"",correo:"",especialidad:null}}cargarEspecialidades(){this.espSvc.listar().subscribe({next:i=>this.especialidades=i,error:i=>console.error("Error cargando especialidades",i)})}cargarMedicos(){this.cargando=!0,this.svc.listar(this.busqueda).subscribe({next:i=>{this.medicos=i,this.cargando=!1},error:i=>{console.error("Error cargando m\xE9dicos:",i),this.mensaje="Error cargando m\xE9dicos",this.cargando=!1}})}nombreDeEspecialidad(i){let e=this.especialidades.find(d=>d.id===i);return e?e.nombre:`#${i}`}buscar(){this.cargarMedicos()}nuevoMedico(){this.modo="crear",this.formMedico=this.formMedicoPorDefecto(),this.vista="formMedico"}editarMedico(i){this.modo="editar",this.formMedico=I({},i),this.vista="formMedico"}cancelarMedico(){this.vista="lista",this.formMedico=this.formMedicoPorDefecto(),this.modo="crear"}guardarMedico(){this.modo==="crear"?this.svc.crear(this.formMedico).subscribe({next:()=>{this.mensaje="M\xE9dico creado.",this.cancelarMedico(),this.cargarMedicos()},error:i=>{console.error("Error creando m\xE9dico:",i),this.mensaje="Error creando m\xE9dico."}}):this.svc.actualizar(this.formMedico.id,this.formMedico).subscribe({next:()=>{this.mensaje="M\xE9dico actualizado.",this.cancelarMedico(),this.cargarMedicos()},error:i=>{console.error("Error actualizando m\xE9dico:",i),this.mensaje="Error actualizando m\xE9dico."}})}eliminarMedico(i){confirm(`\xBFEliminar al m\xE9dico "${i.nombres}"?`)&&this.svc.eliminar(i.id).subscribe({next:()=>{this.mensaje="M\xE9dico eliminado.",this.cargarMedicos()},error:e=>{console.error("Error eliminando m\xE9dico:",e),this.mensaje="Error eliminando m\xE9dico."}})}formHorarioPorDefecto(){return{id:null,fecha:"",hora:"",disponible:!0}}verHorarios(i){this.medicoActual=i,this.vista="horarios",this.cargarHorarios()}cargarHorarios(){this.medicoActual&&(this.cargandoHorarios=!0,this.horSvc.listar(this.medicoActual.id).subscribe({next:i=>{this.horarios=i,this.cargandoHorarios=!1},error:i=>{console.error("Error cargando horarios:",i),this.mensaje="Error cargando horarios.",this.cargandoHorarios=!1}}))}nuevoHorario(){this.modoHorario="crear",this.formHorario=this.formHorarioPorDefecto()}editarHorario(i){this.modoHorario="editar";let e=i.hora.slice(0,5);this.formHorario={id:i.id,fecha:i.fecha,hora:e,disponible:i.disponible}}cancelarHorario(){this.modoHorario="crear",this.formHorario=this.formHorarioPorDefecto()}guardarHorario(){this.medicoActual&&(this.modoHorario==="crear"?this.horSvc.crear(this.medicoActual.id,{fecha:this.formHorario.fecha,hora:this.formHorario.hora,disponible:this.formHorario.disponible}).subscribe({next:()=>{this.mensaje="Horario creado.",this.cancelarHorario(),this.cargarHorarios()},error:i=>{console.error("Error creando horario:",i),this.mensaje="Error creando horario."}}):this.horSvc.actualizar(this.formHorario.id,{fecha:this.formHorario.fecha,hora:this.formHorario.hora,disponible:this.formHorario.disponible}).subscribe({next:()=>{this.mensaje="Horario actualizado.",this.cancelarHorario(),this.cargarHorarios()},error:i=>{console.error("Error actualizando horario:",i),this.mensaje="Error actualizando horario."}}))}eliminarHorario(i){confirm(`\xBFEliminar el horario ${i.fecha} ${i.hora}?`)&&this.horSvc.eliminar(i.id).subscribe({next:()=>{this.mensaje="Horario eliminado.",this.cargarHorarios()},error:e=>{console.error("Error eliminando horario:",e),this.mensaje="Error eliminando horario."}})}volverAListaMedicos(){this.vista="lista",this.medicoActual=null,this.cancelarHorario()}static \u0275fac=function(e){return new(e||n)(A(P),A(Y),A(V))};static \u0275cmp=k({type:n,selectors:[["app-panel-admin-medicos"]],decls:7,vars:4,consts:[["medForm","ngForm"],["horForm","ngForm"],[1,"container","mt-4"],[1,"text-danger","mb-4"],["class","alert alert-info",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-info"],[1,"row","mb-3","g-2","align-items-center"],[1,"col-sm"],[1,"input-group"],["type","text","placeholder","Buscar m\xE9dico...",1,"form-control",3,"ngModelChange","keyup.enter","ngModel"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"col-auto"],["type","button",1,"btn","btn-success",3,"click"],["class","alert alert-warning",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"alert","alert-warning"],[1,"table-responsive"],[1,"table","table-striped","align-middle"],[2,"width","200px"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-primary","me-1",3,"click"],[1,"btn","btn-sm","btn-danger","me-1",3,"click"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"mt-3",3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["name","nombres","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","correo","type","email","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","especialidad","required","",1,"form-select",3,"ngModelChange","ngModel"],["disabled","",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-success"],["type","button",1,"btn","btn-secondary","ms-2",3,"click"],[3,"ngValue"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"text-primary"],[1,"text-muted"],["type","button",1,"btn","btn-outline-secondary","btn-sm",3,"click"],[1,"my-4"],[1,"row","g-3",3,"ngSubmit"],[1,"col-sm-4"],["type","date","name","fecha","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","time","name","hora","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-sm-4","d-flex","align-items-end"],[1,"form-check","mb-0"],["type","checkbox","id","dispChk","name","disponible",1,"form-check-input",3,"ngModelChange","ngModel"],["for","dispChk",1,"form-check-label"],[1,"col-12"],["class","btn btn-secondary ms-2","type","button",3,"click",4,"ngIf"],[1,"table","table-sm","table-bordered","align-middle"],[1,"table-light"],[2,"width","130px"],[1,"badge",3,"ngClass"],[1,"btn","btn-sm","btn-danger",3,"click"]],template:function(e,d){e&1&&(t(0,"div",2)(1,"h2",3),a(2,"Administrar M\xE9dicos"),r(),h(3,ne,2,1,"div",4)(4,de,13,4,"ng-container",5)(5,pe,24,8,"ng-container",5)(6,ve,35,12,"ng-container",5),r()),e&2&&(c(3),m("ngIf",d.mensaje),c(),m("ngIf",d.vista==="lista"),c(),m("ngIf",d.vista==="formMedico"),c(),m("ngIf",d.vista==="horarios"))},dependencies:[W,j,F,O,Q,L,R,J,z,N,G,$,q,K,U,B],encapsulation:2})};export{ee as PanelAdminMedicos};
